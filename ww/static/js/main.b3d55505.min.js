"use strict";(self.webpackChunkweb_portal_main=self.webpackChunkweb_portal_main||[]).push([[179],{8575:(e,t,s)=>{var a=s(9148),n=s(9313),r=s(4600),l=s(7721),i=s(5948);const o=(0,a.createContext)(),c=e=>{let{children:t}=e;const[s,n]=(0,a.useState)(null),[r,c]=(0,a.useState)(!1);return(0,a.useEffect)((()=>{(async()=>{const e=await l.Z.get("/portal/ui/conf/config.json");null!==e&&void 0!==e&&e.data&&(n(e.data),c(!0))})()}),[]),(0,i.jsx)(i.Fragment,{children:(0,i.jsx)(o.Provider,{value:{config:s,isConfigReady:r},children:t})})},d=o;var m=s(8166);function u(){const{config:e}=(0,a.useContext)(d),t=null===e||void 0===e?void 0:e.clientName,s=(new Date).getFullYear();return(0,i.jsxs)("p",{className:"text-center mt-3",children:["\xa9 ",(0,i.jsx)("span",{className:"text-dark",children:t})," ",s]})}var h=s(8858),x=s(971),j=s(2217),g=s(9538),p=s(1788),b=s(9095),v=s(7690),f=s(1309);function N(){const{config:e}=(0,a.useContext)(d),t=null===e||void 0===e?void 0:e.clientName,s=null===e||void 0===e?void 0:e.version,{user:n,logout:l,hasPermission:o,originalAdminSession:c,revertToAdminSession:m}=(0,a.useContext)(P),[u,N]=(0,a.useState)(!0);(0,a.useEffect)((()=>{e&&N(!1)}),[e]);const w=o("user:write")||o("user:delete")||o("role:create")||o("role:delete"),Z=(0,r.s0)(),k=(e,t)=>(0,i.jsx)(h.Z,{id:"button-tooltip",...e,children:t});return u?(0,i.jsx)(x.Z,{hidden:null===n,variant:"dark",bg:"dark",expand:"lg",collapseOnSelect:!0,fixed:"top",className:"shadow-sm",children:(0,i.jsx)(j.Z,{fluid:!0,className:"justify-content-end p-3",children:(0,i.jsx)(x.Z.Brand,{className:"mx-auto"})})}):(0,i.jsx)(x.Z,{hidden:null===n,variant:"dark",bg:"dark",expand:"lg",collapseOnSelect:!0,fixed:"top",className:"shadow-sm",children:(0,i.jsxs)(j.Z,{fluid:!0,className:"justify-content-end",children:[(0,i.jsxs)(x.Z.Brand,{className:"mx-auto",children:[t," - v",s]}),(0,i.jsx)(x.Z.Toggle,{"aria-controls":"basic-navbar-nav"}),(0,i.jsx)(x.Z.Collapse,{id:"basic-navbar-nav",children:(0,i.jsxs)(g.Z,{className:"ms-auto",children:[o("user:write")&&(0,i.jsx)(p.Z,{placement:"bottom",overlay:e=>k(e,"Reports"),children:(0,i.jsx)(g.Z.Item,{className:"mx-md-2 mb-3 mb-md-0",children:(0,i.jsx)(b.Z,{variant:"light btn-sm",className:"w-100",type:"button",onClick:()=>Z("/dashboard"),children:(0,i.jsx)(v.G,{icon:f.Iz$,className:"text-dark"})})})}),w&&(0,i.jsx)(p.Z,{placement:"bottom",overlay:e=>k(e,"Administration"),children:(0,i.jsx)(g.Z.Item,{className:"mx-md-2 mb-3 mb-md-0",children:(0,i.jsx)(b.Z,{variant:"light btn-sm",className:"w-100",type:"button",href:"".concat(e.baseUrl,"/idm/administration"),children:(0,i.jsx)(v.G,{icon:f.byT,className:"text-dark"})})})}),c&&(0,i.jsx)(g.Z.Item,{className:"mx-md-2 mb-3 mb-md-0",children:(0,i.jsx)(b.Z,{variant:"warning btn-sm",className:"w-100",type:"button",onClick:m,children:"Revert to Admin"})}),w&&(0,i.jsx)(p.Z,{placement:"bottom",overlay:e=>k(e,"Distribution"),children:(0,i.jsx)(g.Z.Item,{className:"mx-md-2 mb-3 mb-md-0",children:(0,i.jsx)(b.Z,{variant:"light btn-sm",className:"w-100",type:"button",onClick:()=>Z("/distribution"),children:(0,i.jsx)(v.G,{icon:f.qZB,className:"text-dark"})})})}),w&&(0,i.jsx)(p.Z,{placement:"bottom",overlay:e=>k(e,"Sku Management"),children:(0,i.jsx)(g.Z.Item,{className:"mx-md-2 mb-3 mb-md-0",children:(0,i.jsx)(b.Z,{variant:"light btn-sm",className:"w-100",type:"button",onClick:()=>Z("/skus"),children:(0,i.jsx)(v.G,{icon:f.VdD,className:"text-dark"})})})}),(0,i.jsx)(p.Z,{placement:"bottom",overlay:e=>k(e,"Account Management"),children:(0,i.jsx)(g.Z.Item,{className:"mx-md-2 mb-3 mb-md-0",children:(0,i.jsx)(b.Z,{variant:"light btn-sm",className:"w-100",type:"button",href:"".concat(e.baseUrl,"/idm/home"),children:(0,i.jsx)(v.G,{icon:f.ILF,className:"text-dark"})})})}),(0,i.jsx)(p.Z,{placement:"bottom",overlay:e=>k(e,"Home"),children:(0,i.jsx)(g.Z.Item,{className:"mx-md-2 mb-3 mb-md-0",children:(0,i.jsx)(b.Z,{variant:"light btn-sm",className:"w-100",type:"button",onClick:()=>Z("/"),children:(0,i.jsx)(v.G,{icon:f.wp6,className:"text-dark"})})})}),(0,i.jsx)(p.Z,{placement:"bottom",overlay:e=>k(e,"Logout"),children:(0,i.jsx)(g.Z.Item,{className:"mx-md-2 mb-3 mb-md-0",children:(0,i.jsx)(b.Z,{variant:"light btn-sm",className:"w-100",type:"button",title:"Logout",onClick:()=>l(),children:(0,i.jsx)(v.G,{icon:f.mXR,className:"text-dark"})})})})]})})]})})}var w=s(558);function Z(){const e=localStorage.getItem("accessToken");return e?{headers:{Authorization:"Bearer "+e}}:{}}var k=s(3066);function y(e){let{totalAssigned:t}=e;return(0,i.jsx)(i.Fragment,{children:(0,i.jsxs)("h5",{children:["Assigned Orders ",(0,i.jsx)(k.Z,{variant:"dark",className:"bg-dark",children:t})]})})}function S(e){let{user:t,details:s,greeting:a="Welcome",totalAssigned:n}=e;const r=null!==t&&void 0!==t&&t.firstName&&null!==t&&void 0!==t&&t.lastName?"".concat(t.firstName," ").concat(t.lastName):t.email;return(0,i.jsxs)(i.Fragment,{children:[null!==t&&null!==s&&(0,i.jsxs)("div",{className:"d-flex justify-content-between flex-column flex-md-row",children:[(0,i.jsxs)(w.Z.Title,{children:[a," ",r]}),void 0!==n&&(0,i.jsx)(y,{totalAssigned:n})]}),(0,i.jsx)("hr",{className:"mt-1"})]})}class C{constructor(e){this.baseUrl=e}getDetails(e){return l.Z.get("".concat(this.baseUrl,"/portal/api/v1/workobject/order/").concat(e,"/details"),Z())}async getAssignedOrders(e){let t={page:arguments.length>1&&void 0!==arguments[1]?arguments[1]:1,pageSize:arguments.length>2&&void 0!==arguments[2]?arguments[2]:10,assignedTo:[e],...arguments.length>3&&void 0!==arguments[3]?arguments[3]:{}};return l.Z.post("".concat(this.baseUrl,"/portal/api/v1/WorkObject/search"),t,Z())}uploadAttachment(e,t,s,a){let n=new FormData;n.append("file",e);let r={method:"post",maxBodyLength:1/0,url:"".concat(this.baseUrl,"/portal/api/v1/Attachment/upload/").concat(t,"/").concat(s,"/").concat(a),headers:{"Content-Type":"multipart/form-data",...Z().headers},data:n};return l.Z.request(r)}bulkAssign(e,t){return l.Z.post("".concat(this.baseUrl,"/portal/api/v1/workobject/assign/bulk"),{userId:t,shopifyOrderIds:e},Z())}manuallyAssign(e,t,s){return l.Z.patch("".concat(this.baseUrl,"/portal/api/v1/workobject/").concat(e,"/assign/override"),{ArtistId:t,PrintFileDesignerId:s},Z())}returnOrder(e,t,s,a){return l.Z.patch("".concat(this.baseUrl,"/portal/api/v1/WorkObject/").concat(e,"/return/").concat(t),{comment:s,resetAttachments:a},Z())}cancelOrder(e){let t={method:"patch",maxBodyLength:1/0,url:"".concat(this.baseUrl,"/portal/api/v1/WorkObject/").concat(e,"/status/8000"),headers:{accept:"text/plain",...Z().headers}};return l.Z.request(t)}updateShippingAddress(e,t){return l.Z.patch("".concat(this.baseUrl,"/portal/api/v1/order/").concat(e,"/address"),t,Z())}updateLineItem(e,t,s,a,n){return l.Z.patch("".concat(this.baseUrl,"/portal/api/v1/order/").concat(e,"/lineitem/").concat(t),{quantity:parseInt(s),sku:a,shippingMethod:parseInt(n)},Z())}addTag(e,t){let s={method:"patch",url:"".concat(this.baseUrl,"/portal/api/v1/WorkObject/").concat(e,"/tag/").concat(t),headers:{accept:"text/plain",...Z().headers}};return l.Z.request(s)}deleteTag(e,t){return l.Z.delete("".concat(this.baseUrl,"/portal/api/v1/WorkObject/").concat(e,"/tag/").concat(t),Z())}forceTransition(e){console.log(e);let t={method:"patch",url:"".concat(this.baseUrl,"/portal/api/v1/WorkObject/").concat(e,"/push"),headers:{accept:"text/plain",...Z().headers}};return l.Z.request(t)}}const I=(0,a.createContext)(),O=e=>{let{children:t}=e;const{config:s}=(0,a.useContext)(d),n="".concat(null===s||void 0===s?void 0:s.baseUrl),r="".concat(null===s||void 0===s?void 0:s.authUrl,"/v1/user"),o="".concat(null===s||void 0===s?void 0:s.authUrl,"/v1/Authentication/refresh"),[c,h]=(0,a.useState)(0),[x,g]=(0,a.useState)(null),[p,b]=(0,a.useState)((()=>{if(localStorage.getItem("userDetails")){return JSON.parse(localStorage.getItem("userDetails"))}return null})),[v,f]=(0,a.useState)((()=>localStorage.getItem("adminSession")?JSON.parse(localStorage.getItem("adminSession")):null)),[k,y]=(0,a.useState)((()=>{if(localStorage.getItem("accessToken")){const e=localStorage.getItem("accessToken"),t=(0,m.Z)(e),s=1e3*t.exp;return Date.now()>s?null:t}return null})),O=(0,a.useCallback)((async()=>{localStorage.removeItem("accessToken"),localStorage.removeItem("userDetails"),localStorage.removeItem("refreshToken"),window.location.href="".concat(n,"/idm/login")}),[n]);(0,a.useEffect)((()=>{if(!k)return;null!==s&&null===x&&g(new C(s.baseUrl));const e=()=>{null!==x&&x.getAssignedOrders(k.id,1,0,null).then((e=>{h(e.data.totalItems)}))},t=()=>{const e=localStorage.getItem("accessToken");if(!e)return;(1e3*(0,m.Z)(e).exp-Date.now())/6e4<5&&(async()=>{const e=localStorage.getItem("refreshToken");if(e)try{const{data:t}=await l.Z.post("".concat(o,"/").concat(e),null,Z());localStorage.setItem("accessToken",t.accessToken),localStorage.setItem("refreshToken",t.refreshToken),localStorage.setItem("userDetails",JSON.stringify(t.user))}catch(t){O()}})()},a=setInterval((()=>{t()}),3e4);null!==x&&0===c&&e();const n=setInterval((()=>{e()}),3e5);return()=>{clearInterval(n),clearInterval(a)}}),[s,x,k,c,O,o]);return(0,i.jsx)(I.Provider,{value:{user:k,details:p,logout:O,baseUrl:n,hasPermission:e=>!!k&&(!!k.role&&k.role.indexOf(e)>-1),getUser:async e=>await l.Z.get("".concat(r,"/").concat(e),Z()),totalAssigned:c,setTotalAssigned:h,revertToAdminSession:()=>{const e=JSON.parse(localStorage.getItem("adminSession"));e&&(localStorage.setItem("accessToken",e.accessToken),localStorage.setItem("refreshToken",e.refreshToken),localStorage.setItem("userDetails",JSON.stringify(e.details)),y(e.user),b(e.details),localStorage.removeItem("adminSession"),f(null))},originalAdminSession:v},children:k?(0,i.jsxs)(i.Fragment,{children:[(0,i.jsx)(N,{}),(0,i.jsxs)(j.Z,{fluid:!0,className:"pt-5 mt-4",children:[(0,i.jsx)(S,{user:k,totalAssigned:c}),t]}),(0,i.jsx)(u,{})]}):(0,i.jsx)(i.Fragment,{children:(0,i.jsx)(j.Z,{fluid:!0,className:"login d-flex justify-content-center align-items-center min-vh-100",children:(0,i.jsxs)(w.Z,{className:"col-12 col-lg-6 shadow mx-auto p-3",children:[(0,i.jsx)(w.Z.Body,{className:"text-center",children:t}),(0,i.jsx)(u,{})]})})})})},P=I;class T{constructor(e){this.baseUrl=e}getWorkObjectStatusLookup(){return l.Z.get("".concat(this.baseUrl,"/portal/api/v1/lookup/workobject/status"),Z())}getUsers(){return l.Z.post("".concat(this.baseUrl,"/api/v1/user/search"),{page:1,pageSize:1e3},Z())}getProductShippingProfiles(){return l.Z.get("".concat(this.baseUrl,"/portal/api/v1/lookup/shopify/shippingprofiles"),Z())}getProducts(){return l.Z.get("".concat(this.baseUrl,"/portal/api/v1/lookup/shopify/products"),Z())}getProductBySku(e){return l.Z.get("".concat(this.baseUrl,"/portal/api/v1/lookup/shopify/products/").concat(e),Z())}createProduct(e){return l.Z.post("".concat(this.baseUrl,"/portal/api/v1/storeproduct"),e,Z())}updateProduct(e,t){return t.shippingMethod=parseInt(t.shippingMethod),t.sensariaProductId=parseInt(t.sensariaProductId),t.numberOfCxImages=parseInt(t.numberOfCxImages),l.Z.post("".concat(this.baseUrl,"/portal/api/v1/storeproduct/").concat(e),t,Z())}deleteProduct(e){return l.Z.delete("".concat(this.baseUrl,"/portal/api/v1/storeproduct/").concat(e),Z())}}class A{constructor(e){this.baseUrl=e}uploadAttachment(e,t,s,a,n){let r=new FormData;r.append("file",e);let i="".concat(this.baseUrl,"/portal/api/v1/Attachment/upload/").concat(t,"/").concat(s,"/").concat(a);null!==n&&(i+="?cxPhotoIndex=".concat(n));let o={method:"post",url:i,headers:{"Content-Type":"multipart/form-data",...Z().headers},data:r};return l.Z.request(o)}bulkUploadAttachment(e,t,s){let a=new FormData;a.append("file",e);let n="".concat(this.baseUrl,"/portal/api/v1/Attachment/upload/").concat(t);s&&"us"!==s&&""!==s&&(n="https://ww-upload-proxy.ecomgraduates.workers.dev/upload/".concat(t,"?environment=prod"));let r={method:"post",url:n,headers:{"Content-Type":"multipart/form-data",...Z().headers},data:a};return l.Z.request(r)}deleteAttatchment(e,t){return l.Z.delete("".concat(this.baseUrl,"/portal/api/v1/attachment/").concat(e,"/attachment/").concat(t),Z())}}class U{constructor(e){this.baseUrl=e}newComment(e,t){return l.Z.post("".concat(this.baseUrl,"/portal/api/v1/comment/").concat(e),{message:t},Z())}replyToComment(e,t,s){return l.Z.post("".concat(this.baseUrl,"/portal/api/v1/comment/").concat(e,"/").concat(s),{message:t},Z())}deleteComment(e,t){return l.Z.delete("".concat(this.baseUrl,"/portal/api/v1/comment/").concat(e,"/").concat(t),Z())}}class F{constructor(e){this.getUsersCapacity=(e,t)=>l.Z.get("".concat(this.baseUrl,"/portal/api/v1/distribution/queue/").concat(e,"/avg/30"),Z()),this.baseUrl=e}getAverageDailyOrders(e){return l.Z.get("".concat(this.baseUrl,"/portal/api/v1/WorkObject/average/daily/").concat(e),Z())}setUserDistribution(e,t,s){return l.Z.patch("".concat(this.baseUrl,"/portal/api/v1/distribution/user/").concat(e,"/").concat(t,"/").concat(s),{},Z())}}class L{constructor(e){this.baseUrl=e}getDetails(e){return l.Z.get("".concat(this.baseUrl,"/portal/api/v1/workobject/order/").concat(e,"/details"),Z())}async bulkDownload(e,t){let s={imageTypes:e,targetWorkObjectIds:t};return l.Z.post("".concat(this.baseUrl,"/portal/api/v1/bulkdownload"),s,Z())}}var D=s(6459);function M(e){let{show:t,onClose:s,message:a,variant:n="success"}=e;const r=["dark","danger","info","success","warning"].includes(n);return(0,i.jsxs)(D.Z,{onClose:s,show:t,delay:5e3,autohide:!0,bg:n,className:"mb-2 shadow-sm",children:[(0,i.jsx)(D.Z.Header,{children:(0,i.jsx)("strong",{className:"me-auto text-".concat(n),children:n.toUpperCase()})}),(0,i.jsx)(D.Z.Body,{className:r?"text-white":"",children:a})]})}const E=()=>{const{toasts:e,hideToastNotification:t}=(0,a.useContext)(W);return(0,i.jsx)("div",{className:"toast-container position-fixed bottom-0 end-0 p-3",children:e.map((e=>(0,i.jsx)("div",{className:"toast-box",children:(0,i.jsx)(M,{show:!0,onClose:()=>t(e.id),message:e.message,variant:e.variant})},e.id)))})};class G{constructor(e){this.baseUrl=e}getCharts(){return l.Z.get("".concat(this.baseUrl,"/portal/api/v1/dashboard"),Z())}getOrdersByStatus(e){return l.Z.post("".concat(this.baseUrl,"/portal/api/v1/WorkObject/search"),e,Z())}}const B=(0,a.createContext)(),z=e=>{let{children:t}=e;const{config:s,isConfigReady:n}=(0,a.useContext)(d),[r,l]=(0,a.useState)(null),[o,c]=(0,a.useState)(null),[m,u]=(0,a.useState)(null),[h,x]=(0,a.useState)(null),[j,g]=(0,a.useState)(null),[p,b]=(0,a.useState)(null),[v,f]=(0,a.useState)(null),[N,w]=(0,a.useState)(null),[Z,k]=(0,a.useState)(null),[y,S]=(0,a.useState)(null),[I,O]=(0,a.useState)(null),[P,D]=(0,a.useState)([]),M=(0,a.useRef)(0);(0,a.useEffect)((()=>{n&&null!==s&&(g(new T(s.baseUrl)),f(new C(s.baseUrl)),k(new G(s.baseUrl)),S(new A(s.baseUrl)),O(new U(s.baseUrl)),b(new F(s.baseUrl)),w(new L(s.baseUrl)))}),[n,s]);const z=()=>null!==o?Promise.resolve(o):j.getUsers().then((e=>(c(e.data.results),e.data.results)));return(0,i.jsxs)(B.Provider,{value:{getWorkObjectStatusLookup:()=>null!==r?Promise.resolve(r):j.getWorkObjectStatusLookup().then((e=>(l(e.data),e.data))),getUserList:z,getUserById:e=>z().then((t=>{const s=t.find((t=>t.id===e));return void 0!==s?void 0===s.metadata.firstName||void 0===s.metadata.lastName?s.metadata.email:"".concat(s.metadata.firstName," ").concat(s.metadata.lastName):e}),(e=>Promise.resolve("Failed to locate user."))),getProductShippingProfiles:()=>null!==h?Promise.resolve(h):j.getProductShippingProfiles().then((e=>(x(e.data),e.data))),setProductShippingProfiles:x,productshippingprofiles:h,getProductsCache:()=>null!==m?Promise.resolve(m):j.getProducts().then((e=>(u(e.data),e.data))),setProductsCache:u,productscache:m,orderService:v,dashboardService:Z,distributionService:p,downloadService:N,lookupService:j,attachmentService:y,commentsService:I,showToastNotification:function(e){let t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:"success";const s="toast-".concat(M.current);D((a=>[...a,{id:s,message:e,variant:t}])),M.current+=1},hideToastNotification:e=>{D((t=>t.filter((t=>t.id!==e))))},toasts:P},children:[null!==j&&t,(0,i.jsx)(E,{})]})},W=B,H=e=>{let{children:t,permission:s}=e;const{user:n,hasPermission:l}=(0,a.useContext)(P);if(n){if(null===s||void 0===s)return t;if(l(s))return t}return(0,i.jsx)(r.Fg,{to:"/unauthorized"})};function K(){const{user:e}=(0,a.useContext)(P),{config:t}=(0,a.useContext)(d),[s,n]=(0,a.useState)(!0);return(0,a.useEffect)((()=>{t&&n(!1)}),[t]),s?(0,i.jsxs)(i.Fragment,{children:[(0,i.jsx)("h1",{className:"text-center",children:"Not Authorized"}),(0,i.jsx)(v.G,{icon:f.e7M,className:"text-warning",size:"6x"}),(0,i.jsx)("h5",{className:"text-center",children:"You're not authorized to view this page"}),(0,i.jsxs)("h5",{className:"text-center",children:["Click ",(0,i.jsx)("a",{href:"/",children:"here"})," to return."]})]}):(0,i.jsx)(i.Fragment,{children:null!==e?(0,i.jsxs)(i.Fragment,{children:[(0,i.jsx)("h1",{className:"text-center",children:"Not Authorized"}),(0,i.jsx)(v.G,{icon:f.e7M,className:"text-warning",size:"6x"}),(0,i.jsx)("h5",{className:"text-center",children:"You're not authorized to view this page"}),(0,i.jsxs)("h5",{className:"text-center",children:["Click ",(0,i.jsx)("a",{href:"/",children:"here"})," to return."]})]}):(0,i.jsxs)(i.Fragment,{children:[(0,i.jsx)("h1",{className:"text-center",children:"Not Logged In"}),(0,i.jsx)(v.G,{icon:f.e7M,className:"text-warning",size:"6x"}),(0,i.jsx)("h5",{className:"text-center",children:"You're not logged in"}),(0,i.jsxs)("h5",{className:"text-center",children:["Login ",(0,i.jsx)("a",{href:"".concat(t.baseUrl,"/idm/login"),children:"here"})]})]})})}function R(e){const t=document.createElement("textarea");t.value=e,document.body.appendChild(t),t.select(),document.execCommand("copy"),document.body.removeChild(t)}var V=s(9655),Y=s(2034),_=s(6156);function X(e){let{status:t}=e;const{config:s}=(0,a.useContext)(d),n=s.statusMap[t.toString()]||{text:"Unknown Status",variant:"bg-dark"};return(0,i.jsx)(k.Z,{className:n.variant,children:n.text})}function q(e){let{status:t}=e;const{config:s}=(0,a.useContext)(d),n=s.sensariaStatusMap[t.toString()]||{text:"Unknown Status",variant:"bg-dark"};return(0,i.jsx)(p.Z,{placement:"top",overlay:e=>((e,t)=>(0,i.jsx)(h.Z,{id:"button-tooltip",...e,children:t}))(e,n.text),children:(0,i.jsx)(k.Z,{className:n.variant,children:n.title})})}var J=s(1489),$=s.n(J);function Q(e){let t=arguments.length>1&&void 0!==arguments[1]&&arguments[1],s=arguments.length>2&&void 0!==arguments[2]&&arguments[2];const a=$()(e);if(a.isValid()){const n=a.tz("America/New_York");if(t){const e=n.format("MM/DD/YYYY"),t=n.format("hh:mm:ss A");return(0,i.jsxs)("span",{children:[e,(0,i.jsx)("br",{}),t]})}if(s)return $()(e).tz("America/New_York").format();{const e=n.format("MM/DD/YYYY hh:mm:ss A");return(0,i.jsx)("span",{children:e})}}return console.log("Invalid date: ".concat(e)),null}function ee(e){var t,s,n,r,l;let{order:o,onPopOverOpen:c,onCheckboxChange:m,index:u,selectedOrders:h,selectedOrderNames:x}=e;const{hasPermission:j}=(0,a.useContext)(P),{config:g}=(0,a.useContext)(d),{getUserList:p}=(0,a.useContext)(W),[N,w]=(0,a.useState)(""),Z=h.some((e=>e.id===o.shopifyOrderId));(0,a.useEffect)((()=>{Promise.all([p()]).then((e=>{let[t]=e;const s=t.find((e=>e.id===o.assignedTo));if(void 0!==s){const{firstName:e,lastName:t}=s.metadata;w("".concat(e," ").concat(t))}else w(o.assignedTo)}))}),[o,p]);const y={maxWidth:"2rem",overflow:"hidden"};return(0,i.jsxs)("tr",{className:Z?"table-active":"",children:[(0,i.jsx)("td",{style:y,children:(0,i.jsxs)(k.Z,{pill:!0,bg:Z?"dark text-white":"secondary",onClick:e=>{m(e,!Z,o.shopifyOrderId,o.orderName,o.id,o.status,u)},style:{cursor:"pointer"},children:[o.orderName," ",Z?(0,i.jsx)(v.G,{icon:f.f8k}):null]})}),(0,i.jsx)("td",{style:y,children:Q(o.workObjectCreatedOn)}),(0,i.jsx)("td",{style:y,children:(0,i.jsx)(X,{status:o.status})}),(0,i.jsx)("td",{style:y,children:null===(t=o.metadata)||void 0===t||null===(s=t.fulfillmentTracker)||void 0===s||null===(n=s.LineItems)||void 0===n?void 0:n.map(((e,t)=>(0,i.jsx)(q,{status:e.Status},t)))}),(0,i.jsxs)("td",{className:"td-tags",children:[null===(r=o.metadata)||void 0===r||null===(l=r.lineItems)||void 0===l?void 0:l.map(((e,t)=>{var s;return(0,i.jsx)(k.Z,{pill:!0,bg:"light border text-dark",className:"me-1",size:"sm",children:null===e||void 0===e||null===(s=e.LineItem)||void 0===s?void 0:s.Name},"".concat(o.id,"-").concat(o.shopifyOrderId,"-").concat(o.orderNumber,"-").concat(e.id,"-lineItemSkuTag-").concat(t))})),o.tags.map(((e,t)=>(0,i.jsx)(k.Z,{pill:!0,bg:"light border text-dark",className:"me-1",size:"sm",children:e},"".concat(o.orderId,"-").concat(o.shopifyOrderId,"-").concat(o.orderNumber,"-orderTag-").concat(t))))]}),(0,i.jsx)("td",{style:y,children:(0,i.jsx)(k.Z,{pill:!0,bg:"dark",children:N})}),(0,i.jsxs)("td",{className:"text-end",children:[(0,i.jsx)(b.Z,{onClick:e=>c(e,o.shopifyOrderId),variant:"secondary",className:"me-1",size:"sm",children:(0,i.jsx)(v.G,{icon:f.Mdf})}),(0,i.jsx)(Y.rU,{to:"/details/".concat(o.shopifyOrderId),children:(0,i.jsx)(b.Z,{variant:"",className:"me-1 btn-brand",size:"sm",children:(0,i.jsx)(v.G,{icon:f.Xcf})})}),j("user:write")?(0,i.jsx)(b.Z,{href:"".concat(g.shopifyUrl,"/admin/orders/").concat(o.shopifyOrderId),rel:"noopener noreferrer",target:"_blank",variant:"success",className:"me-1 bg-shopify",size:"sm",children:(0,i.jsx)(v.G,{icon:_.yvx})}):null]})]})}function te(e){let{results:t,onPopOverOpen:s,onCheckboxChange:a,selectedOrders:n,selectedOrderNames:r}=e;const l=(e,t)=>(0,i.jsx)(h.Z,{id:"button-tooltip",...e,children:t});return(0,i.jsx)(i.Fragment,{children:0===(null===t||void 0===t?void 0:t.totalItems)?(0,i.jsx)("p",{className:"text-muted text-center",children:"No results were found..."}):(0,i.jsxs)(V.Z,{striped:!0,bordered:!0,hover:!0,className:"rounded-table",children:[(0,i.jsx)("thead",{children:(0,i.jsxs)("tr",{children:[(0,i.jsx)("th",{children:"Order #"}),(0,i.jsxs)("th",{children:["Received On",(0,i.jsx)(p.Z,{placement:"top",overlay:e=>l(e,"This is the date and time the order was received by the system."),children:(0,i.jsx)(v.G,{className:"text-muted ms-1",size:"sm",icon:f.FDd})})]}),(0,i.jsxs)("th",{children:["Status",(0,i.jsx)(p.Z,{placement:"top",overlay:e=>l(e,"This is the current status of the order."),children:(0,i.jsx)(v.G,{className:"text-muted ms-1",size:"sm",icon:f.FDd})})]}),(0,i.jsxs)("th",{children:["Sensaria Status",(0,i.jsx)(p.Z,{placement:"top",overlay:e=>l(e,"This is the current status provided by Sensaria."),children:(0,i.jsx)(v.G,{className:"text-muted ms-1",size:"sm",icon:f.FDd})})]}),(0,i.jsxs)("th",{children:["Tags",(0,i.jsx)(p.Z,{placement:"top",overlay:e=>l(e,"These are the tags associated with the order."),children:(0,i.jsx)(v.G,{className:"text-muted ms-1",size:"sm",icon:f.FDd})})]}),(0,i.jsxs)("th",{children:["Assigned To",(0,i.jsx)(p.Z,{placement:"top",overlay:e=>l(e,"This is the person the order is assigned to."),children:(0,i.jsx)(v.G,{className:"text-muted ms-1",size:"sm",icon:f.FDd})})]}),(0,i.jsx)("th",{})]})}),(0,i.jsx)("tbody",{children:null===t||void 0===t?void 0:t.results.map(((e,t)=>(0,i.jsx)(ee,{index:t,order:e,onPopOverOpen:s,selectedOrders:n,selectedOrderNames:r,onCheckboxChange:a},e.id)))})]})})}var se=s(4378),ae=s(9476);function ne(e){let{page:t,totalItems:s,pageSize:a,setPage:n,setPageSize:r}=e;const l=Math.ceil(s/a),o=Math.max(1,t-2),c=Math.min(l,t+3),d=[];for(let m=o;m<=c;m++)d.push((0,i.jsx)(se.Z.Item,{active:m===t,onClick:()=>n(m),children:m},m));return(0,i.jsxs)("div",{className:"text-center",children:[(0,i.jsxs)("div",{className:"d-flex justify-content-center",children:[(0,i.jsxs)(se.Z,{className:"custom-pagination",children:[(0,i.jsx)(se.Z.First,{onClick:()=>n(1),disabled:1===t}),(0,i.jsx)(se.Z.Prev,{onClick:()=>n(t-1),disabled:1===t}),o>1&&(0,i.jsx)(se.Z.Ellipsis,{}),d,c<l&&(0,i.jsx)(se.Z.Ellipsis,{}),(0,i.jsx)(se.Z.Next,{onClick:()=>n(t+1),disabled:t===l}),(0,i.jsx)(se.Z.Last,{onClick:()=>n(l),disabled:t===l})]}),(0,i.jsx)(ae.Z.Group,{className:"d-inline ms-2",children:(0,i.jsxs)(ae.Z.Select,{value:a,onChange:e=>r(Number(e.target.value)),children:[(0,i.jsx)("option",{value:10,children:"10"}),(0,i.jsx)("option",{value:20,children:"20"}),(0,i.jsx)("option",{value:30,children:"30"}),(0,i.jsx)("option",{value:40,children:"40"}),(0,i.jsx)("option",{value:50,children:"50"})]})})]}),(0,i.jsx)("span",{className:"ml-3",children:"Showing page ".concat(t," of ").concat(l," for ").concat(s," results")})]})}var re=s(8407);function le(e){let{message:t,variant:s="primary",size:a}=e;return(0,i.jsxs)("div",{className:"text-center",children:[(0,i.jsx)(re.Z,{animation:"border",role:"status",variant:s,size:a,children:(0,i.jsx)("span",{className:"visually-hidden",children:t||"Loading..."})}),t&&(0,i.jsx)("p",{className:"text-muted",children:t})]})}var ie=s(6790),oe=s(7797),ce=s(6913);const de=e=>{var t,s,a;const n=null!==(t=null===e||void 0===e||null===(s=e.workObject)||void 0===s||null===(a=s.metadata)||void 0===a?void 0:a.lineItems)&&void 0!==t?t:[];return 0===n.length?(0,i.jsx)(ie.Z.Item,{children:(0,i.jsx)("div",{className:"text-center text-muted",children:"Line items not found"})}):n.map(((e,t)=>(0,i.jsxs)(ie.Z.Item,{children:[(0,i.jsx)("strong",{children:e.LineItem.Name.split("-")[0]})," ",(0,i.jsx)("br",{}),(0,i.jsx)("p",{className:"badge bg-brand mb-1 rounded-pill",children:e.LineItem.Name.split("-")[1]})," ",(0,i.jsx)("br",{})]},t)))};function me(e){var t,s;let{show:n,target:r,onClose:l,orderId:o}=e;const{config:c}=(0,a.useContext)(d),{orderService:m}=(0,a.useContext)(W),[u,h]=(0,a.useState)(null),[x,j]=(0,a.useState)(!0);return(0,a.useEffect)((()=>{j(!0),m.getDetails(o).then((e=>{h(e.data)}),(e=>{console.log(e)})).finally((()=>{j(!1)}))}),[o,m,c]),(0,i.jsx)(oe.Z,{show:n,target:r,placement:"left",rootClose:!0,onHide:l,children:(0,i.jsxs)(ce.Z,{id:"popover-contained",className:"shadow",children:[(0,i.jsx)(ce.Z.Header,{as:"h3",children:u&&!x&&(0,i.jsxs)(i.Fragment,{children:[u.workObject&&(0,i.jsx)(X,{status:u.workObject.status}),(0,i.jsx)(k.Z,{className:"bg-dark float-end",children:null!==(t=null===(s=u.workObject.metadata.lineItems)||void 0===s?void 0:s.length)&&void 0!==t?t:"0"})]})}),(0,i.jsx)(ce.Z.Body,{children:x?(0,i.jsx)(le,{message:"Loading order details...",size:"sm",variant:"dark"}):u?(0,i.jsx)(ie.Z,{className:"shadow-sm",children:de(u)}):(0,i.jsx)("div",{className:"alert alert-danger",role:"alert",children:"Order not found"})})]})})}var ue=s(8588),he=s(462),xe=s(4515);function je(e){let{onSearch:t,selectedOrders:s,selectedWorkObjectIds:n,setShowBulkAssignModal:r,setShowBulkDownloadModal:l,handleDeselectAll:o}=e;const{user:c,hasPermission:d}=(0,a.useContext)(P),{getUserList:m,getWorkObjectStatusLookup:u}=(0,a.useContext)(W),[h,x]=(0,a.useState)([]),[j,g]=(0,a.useState)([]),[p,N]=(0,a.useState)([]),[w,Z]=(0,a.useState)([]),[k,y]=(0,a.useState)(null),[S,C]=(0,a.useState)(null),[I,O]=(0,a.useState)([]),[T,A]=(0,a.useState)(null),[U,F]=(0,a.useState)(!0),[L,D]=(0,a.useState)([]),[M,E]=(0,a.useState)([]);(0,a.useEffect)((()=>{Promise.all([m(),u()]).then((e=>{let[t,s]=e;const a=t.map((e=>({value:e.id,label:"".concat(e.metadata.firstName," ").concat(e.metadata.lastName)})));g(a),Z([c.id]);const n=Object.entries(s).map((e=>({value:e[1],label:e[0]})));x(n)}))}),[m,u,c]),(0,a.useEffect)((()=>{}),[U]);const G=()=>{const e=k?k+"T04:00:00.000Z":null,s=S?S+"T03:59:59.999Z":null,a={status:p,assignedTo:w,createdOnStart:e||null,createdOnEnd:s?$()(s).add(1,"days"):null,tags:M,order:{orderName:I,customerEmail:T,lineItemSkus:L},descendingOrder:U};a.order.orderName=a.order.orderName.filter((e=>""!==e)),a.customerEmail=""===a.customerEmail?null:a.customerEmail,t(a)},B={Option:e=>{let{innerProps:t,data:s}=e;return(0,i.jsx)("div",{...t,className:"ms-2",children:(0,i.jsx)(X,{status:s.value})})},MultiValueLabel:e=>(0,i.jsx)(X,{status:e.data.value})};return(0,i.jsxs)(ae.Z,{children:[(0,i.jsxs)(ue.Z,{children:[(0,i.jsxs)(ae.Z.Group,{className:"col-md-3",children:[(0,i.jsx)(ae.Z.Label,{children:"Order #"}),(0,i.jsx)(ae.Z.Control,{type:"text",placeholder:"#123456",value:I,onChange:e=>{const t=e.target.value,s=t.includes("#")?t:"#".concat(t);O([s])}})]}),(0,i.jsxs)(ae.Z.Group,{className:"col-md-3",children:[(0,i.jsx)(ae.Z.Label,{children:"Sku"}),(0,i.jsx)(ae.Z.Control,{type:"text",placeholder:"QUO-3351231783",value:L,onChange:e=>D([e.target.value])})]}),(0,i.jsxs)(ae.Z.Group,{className:"col-md-3",children:[(0,i.jsx)(ae.Z.Label,{children:"Tag"}),(0,i.jsx)(ae.Z.Control,{type:"text",placeholder:"tag1",value:M,onChange:e=>E([e.target.value])})]}),(0,i.jsxs)(ae.Z.Group,{className:"col-md-3",children:[(0,i.jsx)(ae.Z.Label,{children:"Customer Email"}),(0,i.jsx)(ae.Z.Control,{type:"email",placeholder:"example@email.com",value:T||"",onChange:e=>A(e.target.value)})]}),d("order:read")&&(0,i.jsxs)(i.Fragment,{children:[(0,i.jsxs)(ae.Z.Group,{className:"col-md-3 mt-md-3 mt-2",children:[(0,i.jsx)(ae.Z.Label,{children:"Status"}),(0,i.jsx)(xe.ZP,{isMulti:!0,options:h,components:B,onChange:e=>N(e.map((e=>e.value))),value:h.filter((e=>p.includes(e.value)))})]}),(0,i.jsxs)(ae.Z.Group,{className:"col-md-3  mt-md-3",children:[(0,i.jsx)(ae.Z.Label,{children:"Assigned to"}),(0,i.jsx)(xe.ZP,{isMulti:!0,options:j,onChange:e=>Z(e.map((e=>e.value))),value:j.filter((e=>w.includes(e.value)))})]})]}),(0,i.jsxs)(i.Fragment,{children:[(0,i.jsxs)(ae.Z.Group,{className:"col-md-3  mt-md-3",children:[(0,i.jsx)(ae.Z.Label,{children:"Created On Start"}),(0,i.jsx)(ae.Z.Control,{type:"date",value:k||"",onChange:e=>y(e.target.value)})]}),(0,i.jsxs)(ae.Z.Group,{className:"col-md-3  mt-md-3",children:[(0,i.jsx)(ae.Z.Label,{children:"Created On End"}),(0,i.jsx)(ae.Z.Control,{type:"date",value:S||"",onChange:e=>C(e.target.value)})]})]})]}),(0,i.jsxs)(ue.Z,{className:"mt-3",children:[(0,i.jsx)(he.Z,{className:"text-start",children:s&&s.length>0&&(0,i.jsxs)(i.Fragment,{children:[(0,i.jsxs)("div",{className:"d-flex mb-n1",children:[(0,i.jsxs)(b.Z,{variant:"light",className:"ms-2",onClick:()=>r(!0),children:[(0,i.jsx)(v.G,{icon:f.jMV})," Bulk Assign",s&&s.length>0&&(0,i.jsx)("span",{className:"badge bg-dark ms-2",children:s.length})]}),(0,i.jsxs)(b.Z,{variant:"light",className:"ms-2",onClick:()=>l(!0),children:[(0,i.jsx)(v.G,{icon:f.q7m})," Bulk Download",s&&s.length>0&&(0,i.jsx)("span",{className:"badge bg-dark ms-2",children:s.length})]}),(0,i.jsxs)(b.Z,{variant:"light",className:"ms-2",onClick:o,children:[(0,i.jsx)(v.G,{icon:f.jAm})," Deselect All"]})]}),(0,i.jsx)("br",{}),(0,i.jsxs)("small",{className:"text-muted rounded bg-light p-3 ms-2 mb-3 d-none d-md-inline",children:["*use ",(0,i.jsx)("span",{className:"bg-dark text-white rounded-1 p-1 text-center ps-2 me-1",children:"SHIFT "})," + ",(0,i.jsx)("span",{className:"bg-dark text-white rounded-1 p-1 text-center ps-2 me-1",children:" C "})," to copy order numbers to clipboard"]})]})}),(0,i.jsxs)(he.Z,{className:"text-end",children:[(0,i.jsxs)(b.Z,{variant:"light",onClick:()=>{F((e=>!e)),setTimeout((()=>{G()}),100)},children:[(0,i.jsx)(v.G,{icon:U?f.MdH:f.J$0})," Sort"]}),(0,i.jsxs)(b.Z,{variant:"light",className:"ms-2",onClick:()=>{o(),N([]),D([]),E([]),Z([c.id]),y(null),C(null),O([]),A(null),G()},children:[(0,i.jsx)(v.G,{icon:f.gPx})," Clear Search"]}),(0,i.jsxs)(b.Z,{variant:"",className:"ms-2 btn-brand text-white",onClick:G,children:[(0,i.jsx)(v.G,{icon:f.Y$T})," Search"]})]})]})]})}var ge=s(9233),pe=s(4380);function be(e){let{selectedOrders:t,showBulkAssignModal:s,setShowBulkAssignModal:n,handleDeselectAll:r}=e;const{orderService:l,distributionService:o,getUserById:c}=(0,a.useContext)(W),[d,m]=(0,a.useState)(null),[u,h]=(0,a.useState)(null),[x,j]=(0,a.useState)(null),[g,p]=(0,a.useState)([]),[v,f]=(0,a.useState)([]),[N,w]=(0,a.useState)([]),[Z,y]=(0,a.useState)([]),[S,C]=(0,a.useState)(0),[I,O]=(0,a.useState)(0),[P,T]=(0,a.useState)("artfile"),[A,U]=(0,a.useState)(!1),[F,L]=(0,a.useState)({}),[D,M]=(0,a.useState)(null),[E,G]=(0,a.useState)(""),[B,z]=(0,a.useState)(!0),[H,K]=(0,a.useState)(!1);(0,a.useEffect)((()=>{o.getUsersCapacity(P).then((e=>{p(e.data)}))}),[o,P]),(0,a.useEffect)((()=>{if(g.length>0){const e=g.map((e=>c(e.userId)));Promise.all(e).then((e=>{const t=e.map(((e,t)=>({value:g[t].userId,label:e})));f(t)}))}}),[g,c]),(0,a.useEffect)((()=>{o.getUsersCapacity("artfile").then((e=>{const t=e.data.map((e=>c(e.userId)));Promise.all(t).then((t=>{const s=t.map(((t,s)=>({value:e.data[s].userId,label:t})));w(s)}))})),o.getUsersCapacity("printfile").then((e=>{const t=e.data.map((e=>c(e.userId)));Promise.all(t).then((t=>{const s=t.map(((t,s)=>({value:e.data[s].userId,label:t})));y(s)}))}))}),[o,c]);const R=()=>n(!1),V=e=>{T(e),m(null)};(0,a.useEffect)((()=>{let e;return A&&D?e=setInterval((()=>{const e=new Date,t=Math.floor((e-D)/1e3),s=Math.floor(t/60),a=t%60;G("".concat(s?"".concat(s," minutes"):""," ").concat(a," seconds"))}),1e3):!A&&D&&clearInterval(e),()=>{e&&clearInterval(e)}}),[A,D]);const Y=t.length?(S+I)/t.filter((e=>e.status>2)).length*100:0,_=t.length?(S+I)/t.filter((e=>e.status<=2)).length*100:0;return(0,i.jsx)(i.Fragment,{children:(0,i.jsxs)(ge.Z,{show:s,onHide:R,size:"xl",children:[(0,i.jsx)(ge.Z.Header,{closeButton:!0,children:(0,i.jsx)(ge.Z.Title,{children:"Bulk Assign"})}),(0,i.jsxs)(ge.Z.Body,{children:[A&&(0,i.jsx)(le,{}),B&&(0,i.jsxs)("div",{className:"text-center",children:[(0,i.jsx)(b.Z,{className:"btn-sm rounded-start rounded-0",variant:"artfile"===P?"dark":"light",onClick:()=>V("artfile"),children:"Art File"}),(0,i.jsx)(b.Z,{className:"btn-sm rounded-end rounded-0",variant:"printfile"===P?"dark":"light",onClick:()=>V("printfile"),children:"Print File"}),(0,i.jsxs)("div",{className:"mt-2 mb-3",children:["You're Assigning ",(0,i.jsx)(k.Z,{className:"bg-secondary",children:P}),(0,i.jsx)("hr",{}),(0,i.jsxs)(k.Z,{className:"bg-dark ms-2",children:["Total Orders Selected: ",t.length]})," |",(0,i.jsxs)(k.Z,{className:"bg-danger ms-2",children:["Failed: ",S]})," |",(0,i.jsxs)(k.Z,{className:"bg-success ms-2",children:["Succeeded: ",I]})]}),(0,i.jsx)(pe.Z,{variant:"success",now:Y,label:"".concat(Math.round(Y),"%"),className:"mt-3"}),(0,i.jsx)("div",{className:"mt-2",children:E&&"Elapsed Time: ".concat(E)})]}),!B&&(0,i.jsxs)("div",{className:"text-center",children:[(0,i.jsxs)("div",{className:"mt-2 mb-3",children:[(0,i.jsxs)(k.Z,{className:"bg-dark ms-2",children:["Total Orders Selected: ",t.length]})," |",(0,i.jsxs)(k.Z,{className:"bg-danger ms-2",children:["Failed: ",S]})," |",(0,i.jsxs)(k.Z,{className:"bg-success ms-2",children:["Succeeded: ",I]})]}),(0,i.jsx)(pe.Z,{variant:"success",now:_,label:"".concat(Math.round(_),"%"),className:"mt-3"}),(0,i.jsx)("div",{className:"mt-2",children:E&&"Elapsed Time: ".concat(E)})]}),B?(0,i.jsx)("div",{className:"mb-3 mt-3 text-center",children:(0,i.jsx)(xe.ZP,{options:v,value:d,onChange:m,placeholder:"Select User",className:"mb-3",styles:{menu:e=>({...e,zIndex:9999})}})}):(0,i.jsxs)("div",{className:"mb-3 mt-3 text-center",children:[(0,i.jsx)(xe.ZP,{options:N,value:u,onChange:h,placeholder:"Select Artist",className:"mb-3",styles:{menu:e=>({...e,zIndex:9999})}}),(0,i.jsx)(xe.ZP,{options:Z,value:x,onChange:j,placeholder:"Select Print File Designer",className:"mb-3",styles:{menu:e=>({...e,zIndex:9999})}})]}),t.length>0&&(0,i.jsxs)("div",{className:"assigned-orders-list mt-2 text-center bg-light border border-secondary rounded pb-0 shadow-sm",style:{maxHeight:"400px",overflowY:"auto"},children:[(0,i.jsx)("p",{className:"mt-3 mb-0",children:"Orders to be assigned:"}),(0,i.jsx)("hr",{}),t.map((e=>{var t;return(0,i.jsxs)("div",{children:[e.orderName," -",(0,i.jsx)(k.Z,{className:"ms-1 ".concat("success"===F[e.orderName]?"bg-success":null!==(t=F[e.orderName])&&void 0!==t&&t.startsWith("already assigned")?"bg-warning":"bg-danger"),children:F[e.orderName]||"pending"})]},e.id)})),(0,i.jsx)("div",{className:"sticky-bottom text-center mt-3 mb-0 w-100",children:I+S===t.length?(0,i.jsx)(b.Z,{variant:"dark",className:"shadow-sm w-100 rounded-0",onClick:()=>{const e=new Date,s="".concat(e.getMonth()+1,"-").concat(e.getDate(),"-").concat(e.getFullYear(),"-").concat(e.getHours(),"-").concat(e.getMinutes(),"-bulk-assign-report.csv"),a="data:text/csv;charset=utf-8,Order Name,Order ID,Assigned To,Status,Timestamp\n"+t.map((e=>"".concat(e.orderName,",").concat(e.id,",").concat(d.label,",").concat(F[e.orderName]||"pending",",").concat((new Date).toLocaleString()))).join("\n"),n=encodeURI(a),r=document.createElement("a");r.setAttribute("href",n),r.setAttribute("download",s),r.click()},children:"Export List"}):H?(0,i.jsx)(b.Z,{variant:"primary",className:"shadow-sm w-100 rounded-0",onClick:()=>{z(!1),K(!1)},children:"Next Step"}):(0,i.jsx)(b.Z,{variant:"dark",className:"shadow-sm w-100 rounded-0",onClick:B?async()=>{if(d&&t.length>0){M(new Date),U(!0),C(0),O(0);const s={};t.forEach((e=>{s[e.id]=e.orderName}));const a=t.filter((e=>e.status>2)),n=25;for(let t=0;t<a.length;t+=n){const r=a.slice(t,t+n).map((e=>e.id));try{const e=(await l.bulkAssign(r,d.value)).data.results;for(const[t,a]of Object.entries(e)){const e=s[t];L((t=>({...t,[e]:a?"success":"already assigned to ".concat(d.label)})))}O((t=>t+Object.values(e).filter((e=>e)).length)),C((t=>t+r.length-Object.values(e).filter((e=>e)).length))}catch(e){C((e=>e+r.length));for(const t of r){const e=s[t];L((t=>({...t,[e]:"failed"})))}}await new Promise((e=>setTimeout(e,0)))}U(!1);t.filter((e=>e.status<=2)).length>0?K(!0):z(!1)}}:async()=>{if(u&&x&&t.length>0){M(new Date),U(!0),C(0),O(0);const s={};t.forEach((e=>{s[e.id]=e.orderName}));const a=t.filter((e=>e.status<=2));for(const t of a){try{await l.manuallyAssign(t.workObjectId,u.value,x.value),L((e=>({...e,[t.orderName]:"success"}))),O((e=>e+1))}catch(e){L((e=>({...e,[t.orderName]:"failed"}))),C((e=>e+1))}await new Promise((e=>setTimeout(e,0)))}U(!1),z(!1)}},disabled:A,children:A?(0,i.jsx)(i.Fragment,{children:(0,i.jsx)(le,{variant:"light"})}):"Confirm and Assign"})})]})]}),(0,i.jsx)(ge.Z.Footer,{children:(0,i.jsx)(b.Z,{variant:"secondary",onClick:R,children:"Close"})})]})})}var ve=s(5975);function fe(e){let{selectedWorkObjectIds:t,showBulkDownloadModal:s,setShowBulkDownloadModal:n,handleDeselectAll:r}=e;const{downloadService:l}=(0,a.useContext)(W),[o,c]=(0,a.useState)([]),[d,m]=(0,a.useState)(!1),[u,h]=(0,a.useState)(null),[x,j]=(0,a.useState)("success"),g=()=>{n(!1),m(!1),h(null)};return(0,i.jsxs)(ge.Z,{show:s,onHide:g,size:"lg",children:[(0,i.jsx)(ge.Z.Header,{closeButton:!0,children:(0,i.jsx)(ge.Z.Title,{className:"h4",children:"Bulk Download"})}),(0,i.jsxs)(ge.Z.Body,{children:[d&&(0,i.jsx)(le,{}),u&&(0,i.jsx)(ve.Z,{variant:x,children:u}),(0,i.jsx)("div",{className:"mb-3",children:(0,i.jsxs)("h5",{children:["Selected Orders:",(0,i.jsxs)(k.Z,{className:"bg-dark ms-2 pt-1 pb-1",children:[t.length," Orders Selected"]})]})}),(0,i.jsx)("div",{className:"mb-3",children:(0,i.jsx)(xe.ZP,{isMulti:!0,options:[{value:"cx",label:"CX"},{value:"artfile",label:"Artfile"},{value:"printfile",label:"Printfile"}],value:o,onChange:e=>{c(e)},placeholder:"Select Image Types"})}),(0,i.jsx)("div",{className:"text-end",children:(0,i.jsx)(b.Z,{variant:"dark",className:"btn btn-dark",onClick:async()=>{if(t.length>0&&o.length>0){m(!0);try{await l.bulkDownload(o.map((e=>e.value)),t),h("Download job created successfully. You will receive an email with the download link in a few minutes."),j("success"),r()}catch(e){h("Error creating download job: ".concat(e.message)),j("danger")}finally{m(!1)}}},disabled:d||0===t.length||0===o.length,children:d?"Processing Download...":"Download"})})]}),(0,i.jsx)(ge.Z.Footer,{children:(0,i.jsx)(b.Z,{variant:"secondary",onClick:g,children:"Close"})})]})}function Ne(){const{user:e}=(0,a.useContext)(P),{config:t}=(0,a.useContext)(d),[s,n]=(0,a.useState)(!1),[r,l]=(0,a.useState)(null),[o,c]=(0,a.useState)(1),[m,u]=(0,a.useState)(10),[h,x]=(0,a.useState)(null),[j,g]=(0,a.useState)((()=>{const e=sessionStorage.getItem("searchFilter");return e?JSON.parse(e):{}})),[p,b]=(0,a.useState)(!1),[v,f]=(0,a.useState)(null),{orderService:N}=(0,a.useContext)(W),[w,Z]=(0,a.useState)(!1),[k,y]=(0,a.useState)(null),[S,C]=(0,a.useState)([]),[I,O]=(0,a.useState)([]),[T,A]=(0,a.useState)([]),U=(0,a.useRef)(null),F=(0,a.useRef)(!1),[L,D]=(0,a.useState)(!1),[M,E]=(0,a.useState)(!1);(0,a.useEffect)((()=>{N.getAssignedOrders(e.id,o,m,j).then((e=>{x(e.data),b(!1),l(null)}),(e=>{n(!0),l(e.message)})).finally((()=>{b(!1)}))}),[o,j,e.id,m,t,N]),(0,a.useEffect)((()=>{sessionStorage.setItem("searchFilter",JSON.stringify(j))}),[j]);(0,a.useEffect)((()=>{A(S.map((e=>e.workObjectId)))}),[S]),(0,a.useEffect)((()=>{const e=e=>{"Shift"===e.key&&(F.current=!0)},t=e=>{"Shift"===e.key&&(F.current=!1)};return window.addEventListener("keydown",e),window.addEventListener("keyup",t),()=>{window.removeEventListener("keydown",e),window.removeEventListener("keyup",t)}}),[]),(0,a.useEffect)((()=>{const e=e=>{if(e.shiftKey&&"KeyC"===e.code){R(I.join("\n"))}};return window.addEventListener("keydown",e),()=>{window.removeEventListener("keydown",e)}}),[I,s]);const G=()=>{C([]),O([]),A([])};return(0,i.jsxs)(i.Fragment,{children:[(0,i.jsx)(je,{onSearch:e=>{n(!1),b(!0),g(e),c(1)},selectedOrders:S,selectedWorkObjectIds:T,showBulkAssignModal:L,setShowBulkAssignModal:D,showBulkDownloadModal:M,setShowBulkDownloadModal:E,handleDeselectAll:G}),(0,i.jsx)("hr",{}),p&&!s?(0,i.jsx)(le,{message:"Searching..."}):s?(0,i.jsx)("div",{className:"alert alert-danger",role:"alert",children:r}):(0,i.jsxs)(i.Fragment,{children:[(0,i.jsx)(te,{results:h,selectedOrders:S,selectedOrderNames:I,onPopOverOpen:(e,t)=>{f(t),y(e.target),Z(!0)},onCheckboxChange:(e,t,s,a,n,r,l)=>{if(F.current&&null!==U.current){const e=Math.min(U.current,l),s=Math.max(U.current,l),a=h.results.slice(e,s+1).map((e=>({id:e.shopifyOrderId,orderName:e.orderName,workObjectId:e.id,status:e.status})));let n;n=t?[...S,...a.filter((e=>!S.some((t=>t.id===e.id))))]:S.filter((e=>!a.some((t=>t.id===e.id)))),C(n)}else C(t?e=>[...e,{id:s,workObjectId:n,orderName:a,status:r}]:e=>e.filter((e=>e.id!==s)));U.current=l}}),(0,i.jsx)(ne,{page:o,pageSize:m,setPageSize:u,totalItems:null===h||void 0===h?void 0:h.totalItems,setPage:e=>(e=>{c(e)})(e)})]}),v&&(0,i.jsx)(me,{show:w,target:k,orderId:v,onClose:()=>{Z(!1)}}),(0,i.jsx)(be,{selectedOrders:S,selectedOrderNames:I,setShowBulkAssignModal:D,showBulkAssignModal:L,handleDeselectAll:G}),(0,i.jsx)(fe,{selectedWorkObjectIds:T,showBulkDownloadModal:M,setShowBulkDownloadModal:E,handleDeselectAll:G})]})}var we=s(6664),Ze=s(4906);function ke(e){let{show:t,onHide:s,workObject:n,fetchWorkObject:r,setAlert:l,setShowReturnModal:o,orderService:c}=e;const[d,m]=(0,a.useState)(""),[u,h]=(0,a.useState)(""),[x,j]=(0,a.useState)(!1);return(0,i.jsxs)(ge.Z,{show:t,onHide:s,children:[(0,i.jsx)(ge.Z.Header,{closeButton:!0,children:(0,i.jsx)(ge.Z.Title,{children:"Return Order"})}),(0,i.jsx)(ge.Z.Body,{children:(0,i.jsxs)(ae.Z,{children:[(0,i.jsxs)(ae.Z.Group,{className:"mb-3",children:[(0,i.jsx)(ae.Z.Label,{children:"Return To"}),(0,i.jsxs)(ae.Z.Select,{"aria-label":"Status select",onChange:e=>m(e.target.value),children:[(0,i.jsx)("option",{children:"Select"}),(0,i.jsx)("option",{value:"3",children:"ArtFile Designer"}),(0,i.jsx)("option",{value:"4",children:"PrintFile Designer"})]})]}),(0,i.jsxs)(ae.Z.Group,{className:"mb-3",children:[(0,i.jsx)(ae.Z.Label,{children:"Comment"}),(0,i.jsx)(ae.Z.Control,{as:"textarea",rows:3,value:u,onChange:e=>h(e.target.value)})]}),(0,i.jsx)(ae.Z.Group,{className:"mb-3",children:(0,i.jsx)(ae.Z.Check,{variant:"dark",type:"switch",id:"remove-image-switch",label:"Remove Image",onChange:e=>j(e.target.checked)})}),(0,i.jsx)("div",{className:"text-end",children:(0,i.jsx)(b.Z,{variant:"dark",onClick:()=>{c.returnOrder(n.workObject.id,parseInt(d),u,x).then((e=>{l({show:!0,message:"Order returned successfully",variant:"success"}),o(!1),r()})).catch((e=>{l({show:!0,message:"Failed to return order",variant:"danger"})}))},disabled:!d||!u,children:"Submit Return"})})]})})]})}function ye(e){let{show:t,onHide:s,orderService:n,workObject:r,fetchWorkObject:l,setAlert:o,setShowAssignModal:c}=e;const[d,m]=(0,a.useState)([]),[u,h]=(0,a.useState)(null),{distributionService:x,getUserById:j}=(0,a.useContext)(W),[g,p]=(0,a.useState)("artfile"),v=(0,a.useCallback)((()=>{x.getUsersCapacity(g).then((e=>{const t=[],s=a=>{if(a>=e.data.length)return void m(t);const n=e.data[a].userId;j(n).then((e=>{t.push({value:n,label:e}),s(a+1)})).catch((e=>{console.error("Error processing user:",e),s(a+1)}))};s(0)})).catch((e=>console.error("Error fetching users:",e)))}),[x,j,g]);(0,a.useEffect)((()=>{v()}),[v]);const f=e=>{p(e)};return(0,i.jsx)(i.Fragment,{children:d&&(0,i.jsxs)(ge.Z,{show:t,onHide:s,children:[(0,i.jsx)(ge.Z.Header,{closeButton:!0,children:(0,i.jsx)(ge.Z.Title,{children:"Assign Order"})}),(0,i.jsxs)(ge.Z.Body,{children:[(0,i.jsxs)("div",{className:"text-center",children:[(0,i.jsx)(b.Z,{className:"btn-sm rounded-start rounded-0",variant:"artfile"===g?"dark":"light",onClick:()=>f("artfile"),children:"Art File"}),(0,i.jsx)(b.Z,{className:"btn-sm rounded-end rounded-0",variant:"printfile"===g?"dark":"light",onClick:()=>f("printfile"),children:"Print File"})]}),(0,i.jsx)(ae.Z,{className:"mt-3",children:(0,i.jsxs)(ae.Z.Group,{className:"mb-3",children:[(0,i.jsx)(ae.Z.Label,{children:"Assign To"}),(0,i.jsx)(xe.ZP,{options:d,value:u,onChange:h,placeholder:"Select User"})]})})]}),(0,i.jsxs)(ge.Z.Footer,{children:[(0,i.jsx)(b.Z,{variant:"secondary",onClick:s,children:"Close"}),(0,i.jsx)(b.Z,{variant:"dark",onClick:()=>{n.bulkAssign([r.workObject.shopifyOrderId],u.value).then((e=>{o({show:!0,message:"Order assigned successfully",variant:"success"}),c(!1),l()})).catch((e=>{o({show:!0,message:"Failed to assign order",variant:"danger"})}))},children:"Assign Order"})]})]})})}function Se(e){let{show:t,onHide:s,orderService:n,workObject:r,fetchWorkObject:l,setAlert:o,setShowManuallyAssignModal:c}=e;const[d,m]=(0,a.useState)([]),[u,h]=(0,a.useState)([]),[x,j]=(0,a.useState)(null),[g,p]=(0,a.useState)(null),{distributionService:v,getUserById:f}=(0,a.useContext)(W),N=(0,a.useCallback)((()=>{const e=(e,t)=>{v.getUsersCapacity(e).then((e=>{const s=[],a=n=>{if(n>=e.data.length)return void t(s);const r=e.data[n].userId;f(r).then((e=>{s.push({value:r,label:e}),a(n+1)})).catch((e=>{console.error("Error processing user:",e),a(n+1)}))};a(0)})).catch((t=>console.error("Error fetching ".concat(e," users:"),t)))};e("artfile",m),e("printfile",h)}),[v,f]);(0,a.useEffect)((()=>{N()}),[N]);return(0,i.jsx)(i.Fragment,{children:(0,i.jsxs)(ge.Z,{show:t,onHide:s,children:[(0,i.jsx)(ge.Z.Header,{closeButton:!0,children:(0,i.jsx)(ge.Z.Title,{children:"Assign Order"})}),(0,i.jsxs)(ge.Z.Body,{children:[(0,i.jsxs)(ae.Z,{className:"mt-3",children:[(0,i.jsxs)(ae.Z.Group,{className:"mb-3",children:[(0,i.jsx)(ae.Z.Label,{children:"Assign Artist"}),(0,i.jsx)(xe.ZP,{options:d,value:x,onChange:e=>{j(e),console.log("Selected Artist:",e)},placeholder:"Select Artist"})]}),(0,i.jsxs)(ae.Z.Group,{className:"mb-3",children:[(0,i.jsx)(ae.Z.Label,{children:"Assign Print File Designer"}),(0,i.jsx)(xe.ZP,{options:u,value:g,onChange:e=>{p(e),console.log("Selected Print File Designer:",e)},placeholder:"Select Print File Designer"})]})]}),x&&g&&(0,i.jsxs)("div",{className:"mt-3",children:[(0,i.jsx)("p",{children:(0,i.jsx)("strong",{children:"Order will be assigned to:"})}),(0,i.jsxs)("p",{children:["Artist: ",(0,i.jsx)("b",{children:x.label})]}),(0,i.jsxs)("p",{children:["Print File Designer: ",(0,i.jsx)("b",{children:g.label})]})]})]}),(0,i.jsxs)(ge.Z.Footer,{children:[(0,i.jsx)(b.Z,{variant:"secondary",onClick:s,children:"Close"}),(0,i.jsx)(b.Z,{variant:"dark",onClick:()=>{x&&g?n.manuallyAssign(r.workObject.id,x.value,g.value).then((e=>{o({show:!0,message:"Order assigned successfully",variant:"success"}),c(!1),l()})).catch((e=>{console.error("Error assigning order:",e),o({show:!0,message:"Failed to assign order",variant:"danger"})})):o({show:!0,message:"Please select both an artist and a print file designer",variant:"warning"})},disabled:!x||!g,children:"Assign Order"})]})]})})}function Ce(e){let{show:t,onHide:s,orderService:a,workObject:n,fetchWorkObject:r,setAlert:l,setShowCancelModal:o}=e;return(0,i.jsxs)(ge.Z,{show:t,onHide:s,children:[(0,i.jsx)(ge.Z.Header,{closeButton:!0,children:(0,i.jsx)(ge.Z.Title,{children:"Cancel Order"})}),(0,i.jsxs)(ge.Z.Body,{children:[(0,i.jsx)("p",{children:"Are you sure you want to cancel this order?"}),(0,i.jsx)(ae.Z,{children:(0,i.jsx)("div",{className:"text-end",children:(0,i.jsx)(b.Z,{variant:"dark",onClick:()=>{a.cancelOrder(n.workObject.id).then((e=>{l({show:!0,message:"Order cancelled successfully",variant:"success"}),o(!1),r()})).catch((e=>{l({show:!0,message:"Failed to cancel order",variant:"danger"})}))},children:"Yes"})})})]})]})}var Ie=s(9970);function Oe(e){var t,s;let{show:n,onHide:r,workObject:l,fetchWorkObject:o,setAlert:c,setShowTagsModal:d}=e;const[m,u]=(0,a.useState)(""),{orderService:h}=(0,a.useContext)(W);return(0,i.jsxs)(ge.Z,{show:n,onHide:r,children:[(0,i.jsx)(ge.Z.Header,{closeButton:!0,children:(0,i.jsx)(ge.Z.Title,{children:"Edit Tags"})}),(0,i.jsxs)(ge.Z.Body,{children:[(0,i.jsx)(ae.Z,{children:(0,i.jsx)(Ie.Z,{children:(0,i.jsx)(ae.Z.Control,{type:"text",placeholder:"Enter tag",value:m,onChange:e=>u(e.target.value)})})}),(null===(t=l.workObject)||void 0===t||null===(s=t.tags)||void 0===s?void 0:s.length)>0?(0,i.jsxs)("div",{className:"mt-3 rounded p-2 border border-light",children:[(0,i.jsxs)("div",{className:"mt-3 text-center",children:[(0,i.jsx)("h5",{className:"mb-0",children:"Current Tags"}),(0,i.jsx)("small",{className:"text-muted",children:"Click to delete a tag"})]}),(0,i.jsx)("div",{className:"mt-3",children:l.workObject.tags.map((e=>(0,i.jsxs)(b.Z,{variant:"danger btn-sm",className:"me-2",onClick:()=>(e=>{h.deleteTag(l.workObject.id,e).then((t=>{c({show:!0,message:"Tag ".concat(e," succesfully deleted "),variant:"success"}),o()})).catch((e=>{c({show:!0,message:"Failed to delete tag",variant:"danger"})})).finally((()=>{d(!1)}))})(e),children:[(0,i.jsx)(v.G,{icon:f.$aW,className:"me-1"})," ",e]})))})]}):(0,i.jsx)("div",{className:"mt-3 text-center",children:(0,i.jsx)("h5",{className:"mb-0",children:"No Tags"})})]}),(0,i.jsxs)(ge.Z.Footer,{children:[(0,i.jsx)(b.Z,{variant:"secondary",onClick:r,children:"Close"}),(0,i.jsx)(b.Z,{variant:"dark",onClick:()=>{h.addTag(l.workObject.id,m).then((e=>{c({show:!0,message:"Tag ".concat(m," succesfully added "),variant:"success"}),o()})).catch((e=>{c({show:!0,message:"Failed to add tag",variant:"danger"})})).finally((()=>{d(!1)}))},children:"Add Tag"})]})]})}function Pe(e){var t,s,n,r;let{workObject:l,orderService:o,fetchWorkObject:c,hasPermission:m,user:u}=e;const{config:x}=(0,a.useContext)(d),[j,g]=(0,a.useState)(""),[N,w]=(0,a.useState)(!1),[Z,k]=(0,a.useState)(!1),[y,S]=(0,a.useState)(!1),[C,I]=(0,a.useState)(!1),[O,P]=(0,a.useState)(!1),[T,A]=(0,a.useState)({show:!1,message:"",variant:""}),U=m("user:write");(0,a.useEffect)((()=>{var e;null!==l&&void 0!==l&&null!==(e=l.workObject)&&void 0!==e&&e.metadata?g(l.workObject.metadata.orderName):g("No order name")}),[l]),(0,a.useEffect)((()=>{if(T.show){const e=setTimeout((()=>{A({show:!1,message:"",variant:""})}),3e3);return()=>clearTimeout(e)}}),[T]);const F=(e,t)=>(0,i.jsx)(h.Z,{id:"button-tooltip",...e,children:t});return(0,i.jsxs)(i.Fragment,{children:[(0,i.jsx)("div",{className:"bg-brand text-white p-2 mb-3 rounded border-primary border",children:(0,i.jsxs)("div",{className:"d-flex",children:[(0,i.jsxs)("div",{className:"d-flex align-items-center mb-0 me-auto",children:[(0,i.jsx)("h3",{className:"mb-0",children:j||"Not Available"}),null!==u&&void 0!==u&&null!==(t=u.email)&&void 0!==t&&t.includes("ecomgraduates.com")?(0,i.jsxs)("h4",{className:"mb-0 ms-2",children:[" workObjectID: #",l.workObject.id]}):null]}),U&&(9003===l.workObject.status||3===l.workObject.status||4===l.workObject.status)&&(0,i.jsx)(p.Z,{placement:"top",overlay:e=>{var t;return F(e,"Force transition to status ".concat(9003===(null===l||void 0===l||null===(t=l.workObject)||void 0===t?void 0:t.status)?"Pending Assignment":"Pending Printfile"))},children:(0,i.jsx)(b.Z,{variant:"primary",size:"md",className:"mx-2 bg-transparent text-white border-0",onClick:()=>{return e=l.workObject.id,void o.forceTransition(e).then((()=>{A({show:!0,message:"Successfully transitioned to next status",variant:"success"}),c()})).catch((()=>{A({show:!0,message:"Failed to transition to next status",variant:"danger"})}));var e},children:(0,i.jsx)(v.G,{icon:f.irl})})}),U&&(0,i.jsx)(p.Z,{placement:"top",overlay:e=>F(e,"Manage Tags"),children:(0,i.jsx)(b.Z,{variant:"primary",size:"md",className:"mx-2 bg-transparent text-white border-0",onClick:()=>{P(!0)},children:(0,i.jsx)(v.G,{icon:f.tho})})}),8e3!==(null===l||void 0===l||null===(s=l.workObject)||void 0===s?void 0:s.status)&&U&&(0,i.jsx)(p.Z,{placement:"top",overlay:e=>F(e,"Assign Order"),children:(0,i.jsx)(b.Z,{variant:"primary",size:"md",className:"mx-2 bg-transparent text-white border-0",onClick:()=>{l.workObject.status<=2?I(!0):S(!0)},children:(0,i.jsx)(v.G,{icon:f.FVb})})}),(0,i.jsx)(p.Z,{placement:"top",overlay:e=>F(e,"Return Order to Previous Status"),children:(0,i.jsx)(b.Z,{variant:"primary",size:"md",className:"mx-2 bg-transparent text-white border-0",onClick:()=>{w(!0)},children:(0,i.jsx)(v.G,{icon:f.XnX})})}),8e3!==(null===l||void 0===l||null===(n=l.workObject)||void 0===n?void 0:n.status)&&U&&(0,i.jsx)(p.Z,{placement:"top",overlay:e=>F(e,"Cancel Order"),children:(0,i.jsx)(b.Z,{variant:"primary",size:"md",className:"mx-2 bg-transparent text-white border-0",onClick:()=>{k(!0)},children:(0,i.jsx)(v.G,{icon:f.jAm})})}),8e3!==(null===l||void 0===l||null===(r=l.workObject)||void 0===r?void 0:r.status)&&U&&(0,i.jsx)(p.Z,{placement:"top",overlay:e=>F(e,"View in Shopify"),children:(0,i.jsx)(b.Z,{variant:"primary",size:"md",href:"".concat(x.shopifyUrl,"/admin/orders/").concat(l.workObject.shopifyOrderId),rel:"noopener noreferrer",target:"_blank",className:"mx-2 bg-transparent text-white border-0",children:(0,i.jsx)(v.G,{icon:_.yvx})})})]})}),(0,i.jsx)("hr",{}),T.show&&(0,i.jsx)(ve.Z,{dismissible:!0,variant:T.variant,children:T.message}),(0,i.jsx)(ke,{show:N,onHide:()=>w(!1),workObject:l,fetchWorkObject:c,setShowReturnModal:w,setAlert:A,orderService:o}),(0,i.jsx)(ye,{show:y,onHide:()=>S(!1),orderService:o,workObject:l,fetchWorkObject:c,setShowAssignModal:S,setAlert:A}),(0,i.jsx)(Se,{show:C,onHide:()=>I(!1),orderService:o,workObject:l,fetchWorkObject:c,setAlert:A,setShowManuallyAssignModal:I}),(0,i.jsx)(Ce,{show:Z,onHide:()=>k(!1),orderService:o,workObject:l,setShowCancelModal:k,setAlert:A,fetchWorkObject:c}),(0,i.jsx)(Oe,{show:O,onHide:()=>P(!1),orderService:o,workObject:l,setShowTagsModal:P,setAlert:A,fetchWorkObject:c})]})}function Te(e){let{workObject:t}=e;const{config:s}=(0,a.useContext)(d),{getUserList:n}=(0,a.useContext)(W),r=t.transitions||[],l=t.status,[o,c]=(0,a.useState)([]);let m;(0,a.useEffect)((()=>{n().then((e=>{c(e)}))}),[t,n]);const u=Array.from({length:8},((e,t)=>t)),x=l<0||l>=8e3,j=r.length?r[r.length-1].sourceStatus:null,g=x?u.slice(0,j+1):u,b=x?"subway-line-progress-bar-item-error":"subway-line-progress-bar-item",N=e=>{const t=o.find((t=>t.id===e));return void 0!==t?void 0===t.metadata.firstName||void 0===t.metadata.lastName?t.metadata.email:"".concat(t.metadata.firstName," ").concat(t.metadata.lastName):e};return(0,i.jsx)("div",{children:(0,i.jsxs)(pe.Z,{className:"mb-3 subway-line-progress-bar",children:[g.map(((e,t)=>{let a,n;const o=0===e?r.find((t=>t.sourceStatus===e)):r.find((t=>t.destinationStatus===e)),c=null!==o&&void 0!==o?((e,t,a,n)=>{var r;const l=(null===(r=s.statusMap[e.toString()])||void 0===r?void 0:r.text)||"Unknown Status",i=t?"on ".concat(new Date(t).toLocaleString()):"",o=n?"Transitioned to ".concat(n):"",c=a?"by ".concat(a):"";return"".concat(l," ").concat(o," ").concat(c," ").concat(i)})(e,o.timestamp,N(o.sourceUser),N(o.destinationUser)):"Not yet reached",d=r.some((t=>t.destinationStatus===e)),u=e<l&&d,j=e>l;return e===l&&d?(a=x?"bg-warning":"bg-light-green",n=f.RrC,m="ms-2"):u||0===e?(a="bg-current-step",n=f.f8k,m="ms-2"):j?(a="bg-secondary",n=null,m=null):(a="bg-secondary",n=f.nYk,m="ms-2"),(0,i.jsx)(pe.Z,{now:1/g.length*100,className:"".concat(a," border-end subway-line-progress-bar ").concat(b),label:(0,i.jsx)(i.Fragment,{children:(0,i.jsx)(p.Z,{placement:"top",overlay:(0,i.jsx)(h.Z,{id:"tooltip-".concat(e),children:c}),children:(0,i.jsxs)("div",{style:{display:"flex",alignItems:"center",justifyContent:"center"},className:m,children:[n&&(0,i.jsx)(v.G,{icon:n,className:"subway-line-icon"}),(0,i.jsx)(k.Z,{className:"".concat(a," subway-line-badge bg-transparent"),children:s.statusMap[e.toString()].text})]})},e)})},t)})),x&&(0,i.jsx)(pe.Z,{now:1/g.length*100,className:"bg-danger subway-line-progress-bar ".concat(b),label:(0,i.jsxs)("div",{style:{display:"flex",alignItems:"center",justifyContent:"center"},className:m,children:[(0,i.jsx)(v.G,{icon:f.nYk,className:"subway-line-icon"}),(0,i.jsx)(k.Z,{className:"bg-danger subway-line-badge bg-transparent",children:s.statusMap[l.toString()].text})]})})]})})}function Ae(e){const t=new Date(e),s=(new Date-t)/1e3/60,a=s/60,n=a/24,r=n/7;return r>=1?"".concat(Math.floor(r)," weeks ago"):n>=1?"".concat(Math.floor(n)," days ago"):a>=1?"".concat(Math.floor(a)," hours ago"):s>=1?"".concat(Math.floor(s)," minutes ago"):"Just now"}function Ue(e){let{workObject:t}=e;const{getUserById:s}=(0,a.useContext)(W),[n,r]=(0,a.useState)(null),[l,o]=(0,a.useState)(null),[c,d]=(0,a.useState)(null);return(0,a.useEffect)((()=>{Promise.all([s(t.assignedTo),s(t.assignedToPrevious),s(t.designatedPrintFileDesigner)]).then((e=>{r(e[0]),o(e[1]),d(e[2])}))}),[t,s]),(0,i.jsx)(i.Fragment,{children:(0,i.jsxs)(ue.Z,{children:[(0,i.jsx)(Fe,{icon:f.SZw,name:"Created On",value:new Date(t.workObjectCreatedOn).toLocaleString(),muted:Ae(t.workObjectCreatedOn)}),(0,i.jsx)(Fe,{icon:f.ILF,name:"Assigned To",value:n}),(0,i.jsx)(Fe,{icon:f.hnx,name:"Assigned On",value:new Date(t.assignedOn).toLocaleString(),muted:Ae(t.assignedOn)}),(0,i.jsx)(Fe,{icon:f.ILF,name:"Previously Assigned",value:l}),(0,i.jsx)(Fe,{icon:f.ILF,name:"Print File Designer",value:c})]})})}function Fe(e){let{icon:t,name:s,value:a,muted:n}=e;return(0,i.jsxs)(he.Z,{className:"text-center p-3",children:[(0,i.jsx)(v.G,{icon:t,size:"2x"})," ",(0,i.jsx)("br",{}),(0,i.jsx)("b",{children:s}),(0,i.jsx)("br",{}),a,void 0!==n&&(0,i.jsxs)(i.Fragment,{children:[(0,i.jsx)("br",{}),(0,i.jsx)("span",{className:"text-muted",children:n})]})]})}const Le=e=>e?(0,i.jsxs)(ie.Z.Item,{className:"mb-2",children:[(0,i.jsx)("span",{className:"fw-bold",children:"SKU: "}),(0,i.jsx)(k.Z,{className:"bg-brand mb-1 rounded-pill",children:e.variantSku})," ",(0,i.jsx)("br",{}),(0,i.jsx)("span",{className:"fw-bold",children:"Option 1: "}),(0,i.jsx)(k.Z,{className:"bg-brand mb-1 rounded-pill",children:e.option1})," ",(0,i.jsx)("br",{}),(0,i.jsx)("span",{className:"fw-bold",children:"Option 2: "}),(0,i.jsx)(k.Z,{className:"bg-brand mb-1 rounded-pill",children:e.option2})," ",(0,i.jsx)("br",{}),(0,i.jsx)("span",{className:"fw-bold",children:"Option 3: "}),(0,i.jsx)(k.Z,{className:"bg-brand mb-1 rounded-pill",children:e.option3})," ",(0,i.jsx)("br",{}),(0,i.jsx)("span",{className:"fw-bold",children:"Shipping Method: "}),(0,i.jsx)(k.Z,{className:"bg-brand mb-1 rounded-pill",children:e.shippingMethod})," ",(0,i.jsx)("br",{}),(0,i.jsx)("span",{className:"fw-bold",children:"Sensaria Product ID: "}),(0,i.jsx)(k.Z,{className:"bg-brand mb-1 rounded-pill",children:e.sensariaProductId})," ",(0,i.jsx)("br",{}),(0,i.jsx)("span",{className:"fw-bold",children:"Artfile Required: "}),(0,i.jsx)(k.Z,{className:"bg-brand mb-1 rounded-pill",children:e.artfileNeeded?"Yes":"No"})," ",(0,i.jsx)("br",{}),(0,i.jsx)("span",{className:"fw-bold",children:"CX Images: "}),(0,i.jsx)(k.Z,{className:"bg-brand mb-1 rounded-pill",children:e.numberOfCxImages})," ",(0,i.jsx)("br",{})]}):(0,i.jsx)(ie.Z.Item,{children:(0,i.jsx)("div",{className:"text-center text-muted",children:"SKU details not found"})});function De(e){let{show:t,target:s,onClose:n,sku:l}=e;const{lookupService:o}=(0,a.useContext)(W),[c,d]=(0,a.useState)(null),[m,u]=(0,a.useState)(!0),h=(0,r.s0)(),x=(0,r.TH)();(0,a.useEffect)((()=>{u(!0),o.getProducts().then((e=>{const t=e.data.find((e=>e.variantSku===l));d(t)})).catch((e=>{console.log(e)})).finally((()=>{u(!1)}))}),[l,o]);return(0,i.jsx)(oe.Z,{show:t,target:s,placement:"right",rootClose:!0,onHide:n,children:(0,i.jsxs)(ce.Z,{id:"popover-contained",className:"shadow",children:[(0,i.jsx)(ce.Z.Header,{as:"h3",className:"text-white",children:m?(0,i.jsx)("strong",{children:"Loading..."}):c?(0,i.jsx)("strong",{children:c.title}):(0,i.jsx)("strong",{children:"SKU not found"})}),(0,i.jsxs)(ce.Z.Body,{children:[m?(0,i.jsx)(le,{message:"Loading SKU details...",size:"sm",variant:"dark"}):c?(0,i.jsx)(ie.Z,{className:"shadow-sm",children:Le(c)}):(0,i.jsx)("div",{className:"alert alert-danger",role:"alert",children:"SKU not found"}),(0,i.jsx)("div",{className:"text-end mt-2",children:c?(0,i.jsx)(b.Z,{className:"btn-sm btn-brand",onClick:()=>{n(),h("/skus?edit=".concat(l),{state:{from:x}})},children:"Edit"}):(0,i.jsx)(b.Z,{className:"btn-sm btn-brand",onClick:()=>{n(),h("/skus?new=".concat(l),{state:{from:x}})},children:"Create"})})]})]})})}function Me(e){let{workObject:t,lineItem:s,product:n,fetchWorkObject:r,productshippingprofiles:l,productsCache:o,orderService:c}=e;const[d,m]=(0,a.useState)(s.SKU),[u,x]=(0,a.useState)(s.Quantity),[j,g]=(0,a.useState)(null===n||void 0===n?void 0:n.ShippingMethod),[N,w]=(0,a.useState)(!1),[Z,y]=(0,a.useState)(!1),[S,C]=(0,a.useState)(null),{hasPermission:I}=(0,a.useContext)(P);if((0,a.useEffect)((()=>{if(N){const e=setTimeout((()=>{r(),w(!1)}),3e3);return()=>clearTimeout(e)}}),[N,r]),!o||!s)return(0,i.jsx)(le,{variant:"dark",size:"sm"});const O=I("order:write")&&I("line_item:write"),T=null===o||void 0===o?void 0:o.find((e=>e.variantSku===s.SKU&&null!==e.shippingMethod&&null!==e.sensariaProductId)),A=null===o||void 0===o?void 0:o.find((e=>e.variantSku===s.SKU)),U=null===o||void 0===o?void 0:o.find((e=>e.variantSku===s.SKU&&null!==e.sensariaProductId)),F=null===o||void 0===o?void 0:o.find((e=>e.variantSku===s.SKU&&null!==e.shippingMethod)),L=null===o||void 0===o?void 0:o.find((e=>e.variantSku===s.SKU&&null!==e.numberOfCxImages&&e.numberOfCxImages>0)),D=null===o||void 0===o?void 0:o.find((e=>e.variantSku===s.SKU&&null!==e.fileType)),M=null===o||void 0===o?void 0:o.find((e=>e.variantSku===s.SKU&&null!==e.artfileNeeded&&!0===e.artfileNeeded)),E=o.filter((e=>l.some((t=>t.id===e.shippingMethod))));let G={};E.forEach((e=>{const t="".concat(e.title," ").concat(e.option3?" - ".concat(e.option3):"");G[t]||(G[t]=[]),G[t].push(e)}));const B=e=>{y(!Z),C(e.target)};G=Object.keys(G).map((e=>({label:e,options:G[e].map((e=>({label:"".concat(e.option1," / ").concat(e.option2," / ").concat(e.option3," (").concat(e.variantSku,")"),value:e.variantSku})))})));const z=G.flatMap((e=>e.options)).find((e=>e.value===d));return(0,i.jsxs)(i.Fragment,{children:[N&&(0,i.jsx)(ve.Z,{variant:"success",children:"Update successful!"}),(0,i.jsx)(ae.Z,{className:"sticky-top-2",children:null!==T&&void 0!==T&&T.shippingMethod&&E.length>0?(0,i.jsxs)(i.Fragment,{children:[(0,i.jsx)("p",{className:"fs-5 mb-1",children:"Details"}),(0,i.jsxs)(ie.Z,{children:[(0,i.jsxs)(ie.Z.Item,{children:[(0,i.jsx)("strong",{children:"SKU:"})," ",s.SKU,(0,i.jsx)(p.Z,{placement:"top",overlay:(0,i.jsx)(h.Z,{id:"button-tooltip",children:"View SKU Details"}),children:(0,i.jsx)(v.G,{icon:f.sqG,className:"ms-2",style:{cursor:"pointer"},onClick:B})}),(0,i.jsx)(De,{show:Z,target:S,onClose:()=>y(!1),sku:s.SKU})]}),(0,i.jsxs)(ie.Z.Item,{children:[(0,i.jsx)("strong",{children:"Variant:"}),(0,i.jsx)(xe.ZP,{value:z,onChange:e=>m(e.value),options:G,isDisabled:!O})]}),(0,i.jsxs)(ie.Z.Item,{children:[(0,i.jsx)("strong",{children:"Qty:"}),(0,i.jsx)(ae.Z.Group,{className:"mb-3 d-flex align-items-center",children:(0,i.jsx)(ae.Z.Control,{disabled:!O,type:"number",value:u,onChange:e=>x(e.target.value),"aria-label":"Quantity"})})]}),(0,i.jsxs)(ie.Z.Item,{children:[(0,i.jsx)("strong",{children:"Shipping Method:"}),(0,i.jsx)(ae.Z.Select,{value:j,onChange:e=>{g(e.target.value)},disabled:!O,children:l.map((e=>(0,i.jsxs)("option",{value:e.id,children:[e.method," (",e.id,")"]},e.id)))})]})]}),(0,i.jsx)("div",{className:"mt-2",children:(0,i.jsx)(b.Z,{variant:"",className:"w-100 btn-brand",onClick:async()=>{c.updateLineItem(t.workObject.shopifyOrderId,s.Id,u,d,j).then((e=>{w(!0)})).catch((e=>{console.log(e)})).finally((()=>{}))},children:"Save"})})]}):(0,i.jsxs)(i.Fragment,{children:[(0,i.jsx)("div",{children:A?(0,i.jsx)(i.Fragment,{children:(0,i.jsx)("p",{className:"text-muted mb-0",children:(()=>{let e=[];return M||e.push("Artfile Needed"),D||e.push("File Type"),L||e.push("Number of CX Images"),U||e.push("Sensaria PID"),F||e.push("Shipping Method"),e.length>0?(0,i.jsxs)(i.Fragment,{children:["This SKU is ignored because the following were set to 0, null, or false:",(0,i.jsx)("ul",{children:e.map(((e,t)=>(0,i.jsx)("li",{children:(0,i.jsx)(k.Z,{bg:"secondary",children:e})},t)))})]}):"You may not have set the SKU correctly."})()})}):(0,i.jsx)(k.Z,{bg:"danger",className:"mb-2",children:"SKU NOT FOUND"})}),(0,i.jsx)("strong",{children:"SKU:"})," ",s.SKU,(0,i.jsx)(p.Z,{placement:"top",overlay:(0,i.jsx)(h.Z,{id:"button-tooltip",children:"View SKU Details"}),children:(0,i.jsx)(v.G,{icon:f.sqG,className:"ms-2",style:{cursor:"pointer"},onClick:B})}),(0,i.jsx)(De,{show:Z,target:S,onClose:()=>y(!1),sku:s.SKU})]})})]})}var Ee=s(3274);function Ge(e){let{properties:t}=e;return(0,i.jsx)(i.Fragment,{children:t&&t.length>0&&(0,i.jsx)(Ee.Z,{className:"mt-2",children:(0,i.jsxs)(Ee.Z.Item,{eventKey:"0",children:[(0,i.jsx)(Ee.Z.Header,{children:(0,i.jsx)("strong",{children:"Properties"})}),(0,i.jsx)(Ee.Z.Body,{children:(0,i.jsx)(ie.Z,{children:t.map(((e,t)=>(0,i.jsxs)("div",{className:"rounded mb-2",children:[(0,i.jsxs)(ie.Z.Item,{children:[(0,i.jsx)("strong",{children:"Title:"})," ",e.name]}),(0,i.jsxs)(ie.Z.Item,{children:[(0,i.jsx)("strong",{children:"Value:"})," ",e.value]})]},"".concat(e.name,"-").concat(t))))})})]})})})}function Be(e){let{image:t,fileName:s}=e;return(0,i.jsxs)(b.Z,{href:t,variant:"outline-dark",className:"w-100 d-flex align-items-center justify-content-center mb-2 mt-2",download:s||"image",children:[(0,i.jsxs)("svg",{xmlns:"http://www.w3.org/2000/svg",width:"16",height:"16",fill:"currentColor",className:"bi bi-download me-2",viewBox:"0 0 16 16",children:[(0,i.jsx)("path",{d:"M.5 9.9a.5.5 0 0 1 .5.5v2.5a1 1 0 0 0 1 1h12a1 1 0 0 0 1-1v-2.5a.5.5 0 0 1 1 0v2.5a2 2 0 0 1-2 2H2a2 2 0 0 1-2-2v-2.5a.5.5 0 0 1 .5-.5z"}),(0,i.jsx)("path",{d:"M7.646 11.854a.5.5 0 0 0 .708 0l3-3a.5.5 0 0 0-.708-.708L8.5 10.293V1.5a.5.5 0 0 0-1 0v8.793L5.354 8.146a.5.5 0 1 0-.708.708l3 3z"})]})," Download"]})}function ze(e){let{onClick:t,isRemoving:s}=e;return(0,i.jsx)(b.Z,{variant:"outline-danger",className:"w-100 d-flex align-items-center justify-content-center mb-2",onClick:t,disabled:s,children:s?(0,i.jsx)(re.Z,{animation:"border",size:"sm"}):(0,i.jsxs)(i.Fragment,{children:[(0,i.jsxs)("svg",{xmlns:"http://www.w3.org/2000/svg",width:"18",height:"18",fill:"currentColor",className:"bi bi-x-circle me-2",viewBox:"0 0 16 16",children:[(0,i.jsx)("path",{d:"M8 15A7 7 0 1 1 8 1a7 7 0 0 1 0 14zm0 1A8 8 0 1 0 8 0a8 8 0 0 0 0 16z"}),(0,i.jsx)("path",{d:"M4.646 4.646a.5.5 0 0 1 .708 0L8 7.293l2.646-2.647a.5.5 0 0 1 .708.708L8.707 8l2.647 2.646a.5.5 0 0 1-.708.708L8 8.707l-2.646 2.647a.5.5 0 0 1-.708-.708L7.293 8 4.646 5.354a.5.5 0 0 1 0-.708z"})]}),"Remove"]})})}const We=(e,t,s,a)=>{const n=e("image_cx:write"),r=e("image_artfile:write"),l=e("image_printfile:write");if(t)return!("printfile"!==s||!l&&!n||4!==a.workObject.status);const i=a.workObject.status;return i>1&&i<6||9003===i?!("cx"!==s||!n)||(!(3!==i||"artfile"!==s||!r&&!n)||!(4!==i||"printfile"!==s||!l&&!n)):void 0};var He=s(9558),Ke=s.n(He),Re=s(7910),Ve=s.n(Re);const Ye=e=>{let{workObjectId:t,workObject:s,imageType:n,attachmentId:r,classes:o,width:c,height:m,petName:u,fileName:h,by:x,uploadedOn:j,fetchWorkObject:g,allowDownload:p=!1,isAddonProduct:b}=e;const[v,f]=(0,a.useState)(null),[N,w]=(0,a.useState)(!1),[y,S]=(0,a.useState)(!1),[C,I]=(0,a.useState)(null),[O,T]=(0,a.useState)(null),{hasPermission:A}=(0,a.useContext)(P),{attachmentService:U,showToastNotification:F,getUserById:L}=(0,a.useContext)(W),D=(0,a.useContext)(d),M=We(A,b,n,s);(0,a.useEffect)((()=>{(async()=>{w(!0);try{const s="".concat(D.config.baseUrl,"/portal/api/v1/attachment/download/").concat(t,"/").concat(r),a=await l.Z.get(s,{...Z(),responseType:"arraybuffer"}),n=new Blob([a.data],{type:"image/jpeg"});let i;try{const e=await Ke()({blob:n,toType:"image/jpeg"});i=URL.createObjectURL(e)}catch(e){if(!e.code||![1,2,3,4,5].includes(e.code))throw I("Failed to load or convert image"),e;if(1!==e.code&&2!==e.code)throw console.log(e.message),I(e.message),e;i=URL.createObjectURL(n)}f(i)}catch(e){console.error("Failed to load or convert image:",e),f(null)}finally{w(!1)}})()}),[t,r,D.config.baseUrl]),(0,a.useEffect)((()=>{x&&L(x).then((e=>{T(e)}))}),[x,L]);return N?(0,i.jsx)(le,{message:"Loading image..."}):N||null!==v?(0,i.jsxs)(i.Fragment,{children:[(0,i.jsxs)("div",{className:"border border-primary rounded shadow-sm mb-2 position-relative ".concat(o),children:[(0,i.jsx)("img",{alt:r,width:c,height:m,src:v,loading:"lazy",objectFit:"contain"}),u&&(0,i.jsx)("p",{className:"bg-secondary p-1 rounded text-white text-center mb-0",children:u}),h&&(0,i.jsx)("p",{className:"bg-secondary p-1 rounded text-white text-center mb-0",children:h})]}),(0,i.jsxs)("div",{className:"ms-3 w-100",children:[j&&(0,i.jsxs)("p",{className:"text-muted mb-0",children:["Uploaded ",Q(j)]}),x&&(0,i.jsxs)("p",{className:"text-muted mb-0",children:["by: ",(0,i.jsx)("span",{className:"badge pill-badge bg-secondary text-white",children:O})]}),p&&(0,i.jsx)(Be,{image:v,fileName:h}),M&&(0,i.jsx)(ze,{onClick:async()=>{if((await Ve().fire({title:"Are you sure?",text:"Do you want to remove this image?",icon:"warning",showCancelButton:!0,confirmButtonText:"Yes, remove it!",cancelButtonText:"No, keep it"})).isConfirmed){S(!0);try{await U.deleteAttatchment(t,r),g(),F("Successfully removed image","success")}catch(e){console.error("Failed to remove image:",e),F("Failed to remove image","danger")}finally{S(!1)}}},isRemoving:y})]})]}):(0,i.jsxs)(k.Z,{variant:"dark",bg:"dark",children:["$",C||"Failed to load image"]})};function _e(e){let{fetchWorkObject:t,workObjectId:s,imageType:n,lineItemId:r,fileTypes:l,config:o,cxPhotoIndex:c,isReplacing:d=!1,isAddonProduct:m,workObject:u,lineItemIndex:h}=e;const{hasPermission:x}=(0,a.useContext)(P),[j,g]=(0,a.useState)(!1),[p,b]=(0,a.useState)(!1),{attachmentService:v,showToastNotification:f}=(0,a.useContext)(W),N=(0,a.useRef)(null),w=We(x,m,n,u);l=l.map((e=>e.replace(".","")));const Z="artfile"===n?o.artfileTypes:l,k=e=>{const t=[],s=[];Array.from(e).forEach((e=>{let a=!1;for(const t of Z)if(e.name.toLowerCase().endsWith(".".concat(t))){a=!0;break}if(a)t.push(e);else{s.push(e);const t="File ".concat(e.name," was rejected because it's not a ").concat(Z.join(", ")," file.");f(t,"warning")}})),d?Ve().fire({title:"Are you sure?",text:"Do you want to replace the existing files?",icon:"warning",showCancelButton:!0,confirmButtonText:"Yes",cancelButtonText:"No"}).then((e=>{e.isConfirmed&&y(t)})):y(t)},y=e=>{e.forEach((e=>{((e,s,a,n,r)=>{e&&(b(!0),v.uploadAttachment(e,s,a,n,r).then((e=>{f("Successfully uploaded ".concat(e.data.fileName),"success"),t()})).catch((e=>{console.log(e),f(e.response.data.Message,"danger")})).finally((()=>{b(!1)})))})(e,s,n,r,c)}))};return"cx"!==n&&"artfile"!==n||!m?"printfile"===n&&3===u.workObject.status?(0,i.jsxs)(ve.Z,{variant:"warning",className:"mb-0 text-center",children:[(0,i.jsx)(ve.Z.Heading,{children:"Warning"}),(0,i.jsx)("p",{className:"mb-0",children:"Artfile is pending please upload artfile"})]}):"printfile"===n&&9003===u.workObject.status?(0,i.jsxs)(ve.Z,{variant:"warning",className:"mb-0 text-center",children:[(0,i.jsx)(ve.Z.Heading,{children:"Warning!"}),(0,i.jsx)("p",{className:"mb-0",children:"Customer photo failure. Please resolve error first"})]}):"artfile"===n&&4===u.workObject.status?(0,i.jsxs)(ve.Z,{variant:"warning",className:"mb-0 text-center",children:[(0,i.jsx)(ve.Z.Heading,{children:"Warning"}),(0,i.jsx)("p",{className:"mb-0",children:"Please return this order. Once returned you may edit the artfile"})]}):"artfile"===n&&9003===u.workObject.status?(0,i.jsxs)(ve.Z,{variant:"warning",className:"mb-0 text-center",children:[(0,i.jsx)(ve.Z.Heading,{children:"Warning"}),(0,i.jsx)("p",{className:"mb-0",children:"Customer photo failure. Please resolve error first"})]}):(console.log(u),(0,i.jsx)(i.Fragment,{children:w&&(0,i.jsxs)("section",{children:[(0,i.jsx)("h6",{className:"text-center bg-brand rounded-top p-1 mb-0 text-white",children:d?"Replace the existing file(s)":"Upload a new ".concat(n)}),(0,i.jsxs)("div",{onDragOver:e=>{e.preventDefault(),g(!0)},onDragLeave:e=>{e.preventDefault(),g(!1)},onDrop:e=>{e.preventDefault(),g(!1),k(e.dataTransfer.files)},className:j?"display-flex justify-content-center align-items-center uploadBoxDragged rounded-bottom shadow position-relative p-2 bg-brand-light text-white text-center":"display-flex justify-content-center align-items-center uploadBox rounded-bottom shadow-sm position-relative p-2 text-muted text-center",children:["artfile"===n&&(0,i.jsxs)("p",{className:"p-2 rounded fw-bold mb-0 alert alert-warning",children:["File Name: ",u.workObject.metadata.orderName.replace("#",""),"-",h+1,"_",c,".","artfile"===n?o.artfileTypes[0].toLowerCase():l.join(", ").toLowerCase()]}),"printfile"===n&&(0,i.jsxs)("p",{className:"p-2 rounded fw-bold mb-0 alert alert-warning",children:["File Name: ",u.workObject.metadata.orderName.replace("#",""),"-",h+1,".","artfile"===n?o.artfileTypes[0].toLowerCase():l.join(", ").toLowerCase()]}),"Drag and drop some files here, or",(0,i.jsx)("button",{className:j?"ms-2 btn btn-sm btn-light my-1":"ms-2 btn btn-sm btn-outline-secondary my-1",onClick:()=>{N.current.click()},children:"click here to select files"}),(0,i.jsx)("br",{}),(0,i.jsxs)("em",{children:["(Only ","artfile"===n?o.artfileTypes[0].toUpperCase():l.join(", ").toUpperCase()," files will be accepted)"]})]}),(0,i.jsx)("input",{ref:N,type:"file",style:{display:"none"},accept:Z.map((e=>".".concat(e))).join(","),multiple:!0,onChange:e=>{k(e.target.files)}}),p?(0,i.jsx)("div",{className:"mt-3",children:(0,i.jsx)(le,{message:"Uploading..."})}):null]})})):"artfile"===n&&u.workObject.status>3&&u.workObject.status<6?(0,i.jsxs)(ve.Z,{variant:"info",className:"mb-0 text-center",children:[(0,i.jsx)(ve.Z.Heading,{children:"Warning"}),(0,i.jsx)("p",{className:"mb-0",children:"This is a linked line item and must be managed via the parent line item"})]}):"artfile"===n?(0,i.jsxs)(ve.Z,{variant:"info",className:"mb-0 text-center",children:[(0,i.jsx)(ve.Z.Heading,{children:"Warning"}),(0,i.jsx)("p",{className:"mb-0",children:"This is a linked line item. Once you upload to the parent line item the image will display here as well"})]}):null}function Xe(e){let{workObjectId:t,attachment:s,fetchWorkObject:a,lineItemId:n,imageType:r,fileTypes:l,config:o,cxPhotoIndex:c,isAddonProduct:d,workObject:m,lineItemIndex:u}=e;const h=null!==s&&void 0!==s,{lineItems:x}=m.workObject;let j=null!==s&&void 0!==s&&s.metadata?function(e,t,s){if(s<1||s>4)return"No name found";for(const a of e)if(a.lineItem.id===t){const e=a.lineItem.properties.find((e=>e.name==="Pet Name ".concat(s)));return e?e.value:"No name found"}return"No name found"}(x,s.metadata.lineItemId,c+1):"No name found";return(0,i.jsxs)("div",{className:"alert alert-light mb-4",children:[(0,i.jsx)("div",{className:"d-flex align-items-center flex-column flex-lg-row flex-md-column",children:s&&(0,i.jsx)(i.Fragment,{children:(0,i.jsx)(Ye,{workObjectId:t,attachmentId:s.id,classes:"rounded rounded-bottom-0",fileName:s.fileName,uploadedOn:s.uploadedOn,petName:j,width:130,by:null===s||void 0===s?void 0:s.userId,fetchWorkObject:a,allowDownload:!0,isAddonProduct:d,workObject:m,imageType:r})})}),l.length>0&&(0,i.jsx)(_e,{cxPhotoIndex:"cx"===r||"artfile"===r?c+1:null,isReplacing:h,lineItemId:n,workObjectId:t,imageType:r,fileTypes:l,fetchWorkObject:a,config:o,isAddonProduct:d,workObject:m,lineItemIndex:u})]})}function qe(e){var t,s,n,r,l,o;let{workObject:c,lineItem:d}=e;const[m,u]=(0,a.useState)("Copy Email"),h=((null===c||void 0===c||null===(t=c.workObject)||void 0===t||null===(s=t.metadata)||void 0===s||null===(n=s.fulfillmentTracker)||void 0===n?void 0:n.LineItems)||[]).find((e=>e.LineItemId===(null===d||void 0===d?void 0:d.Id)));return(0,i.jsx)(i.Fragment,{children:h&&(0,i.jsx)(Ee.Z,{className:"mt-2",children:(0,i.jsxs)(Ee.Z.Item,{eventKey:"0",children:[(0,i.jsxs)(Ee.Z.Header,{children:[(0,i.jsx)("strong",{className:"me-2",children:"Sensaria Details"}),(0,i.jsx)(q,{status:h.Status})]}),(0,i.jsx)(Ee.Z.Body,{children:(0,i.jsx)(ie.Z,{children:(0,i.jsxs)("div",{className:"rounded mb-2",children:[h.TrackingNumber?(0,i.jsxs)(ie.Z.Item,{children:[(0,i.jsx)("strong",{children:"Tracking Number:"})," ",h.TrackingNumber]}):null,(0,i.jsxs)(ie.Z.Item,{children:[(0,i.jsx)("strong",{children:"Sensaria Order ID: "}),null===c||void 0===c||null===(r=c.workObject)||void 0===r||null===(l=r.metadata)||void 0===l||null===(o=l.fulfillmentTracker)||void 0===o?void 0:o.SensariaOrderNumber]}),(0,i.jsxs)(ie.Z.Item,{children:[(0,i.jsx)("strong",{children:"Sensaria Line Item ID: "}),h.LineItemId]}),(0,i.jsxs)(ie.Z.Item,{children:[(0,i.jsx)("strong",{children:"Status: "}),(0,i.jsx)(q,{status:h.Status})]}),h.TrackingUrl?(0,i.jsxs)(ie.Z.Item,{children:[(0,i.jsx)("strong",{children:"Tracking Url:"})," ",(0,i.jsxs)("a",{className:"btn btn-outline-secondary btn sm",href:h.TrackingUrl,target:"_blank",rel:"noopener noreferrer",children:[(0,i.jsx)(v.G,{icon:f.Y_D})," Track Package"]})]}):null,[3,5,16,23,37].includes(h.Status)?(0,i.jsxs)(ie.Z.Item,{children:[(0,i.jsx)("strong",{children:"Sensaria Email Template:"}),(0,i.jsx)("button",{className:"btn btn-outline-secondary btn-sm ms-2",onClick:()=>{var e,t,s,a,n;return a=null===c||void 0===c||null===(e=c.workObject)||void 0===e||null===(t=e.metadata)||void 0===t||null===(s=t.fulfillmentTracker)||void 0===s?void 0:s.SensariaOrderNumber,n=h.LineItemId,R(((e,t)=>"\n        We have an order that has a held status can you please look into this order. \n\n        order id: ".concat(e," \n\n        line item id: ").concat(t," \n\n        thank you, \n\n        "))(a,n)),u("Copied!"),void setTimeout((()=>{u("Copy Email")}),2e3)},children:m})]}):null]})})})]})})})}function Je(e){var t;let{workObject:s,productsCache:a,productshippingprofiles:n,fetchWorkObject:r,config:l,orderService:o}=e;if(null===s||void 0===s||!s.workObject||null===s||void 0===s||null===(t=s.workObject)||void 0===t||!t.attachments)return(0,i.jsx)(le,{message:"Loading line items..."});const c=(e,t)=>"artfile"===e||"printfile"===e?t?[t]:["artfile"===e?".png":".jpg"]:[],d=new Map;s.workObject.metadata.lineItems.forEach((e=>{var t;const s=null===(t=e.LineItem.Properties)||void 0===t?void 0:t.find((e=>"id"===e.Name));s&&d.set(s.Value,e)}));const m=e=>{setTimeout((()=>{const t=document.getElementById(e);t&&t.scrollIntoView({behavior:"smooth"})}),0)};return(0,i.jsxs)("div",{children:[(0,i.jsx)(ue.Z,{children:(0,i.jsx)(he.Z,{md:12,children:(0,i.jsx)("div",{className:"text-start mb-2",children:(0,i.jsx)("h4",{className:"mb-0 ms-1",children:"Line Items"})})})}),(0,i.jsx)(ue.Z,{className:"mb-2",children:s.workObject.metadata.lineItems.map(((e,t)=>{var u,h,x,j,g,p,b,v;const f=s.workObject.id,N=e.LineItem.Id,Z=null===(u=e.LineItem.Properties)||void 0===u?void 0:u.some((e=>"parentId"===e.Name)),k=null===(h=e.LineItem.Properties)||void 0===h?void 0:h.some((e=>"id"===e.Name)),y=null===(x=e.LineItem.Properties)||void 0===x||null===(j=x.find((e=>"parentId"===e.Name)))||void 0===j?void 0:j.Value,S=null===(g=e.LineItem.Properties)||void 0===g||null===(p=g.find((e=>"id"===e.Name)))||void 0===p?void 0:p.Value,C=null===e||void 0===e||null===(b=e.Product)||void 0===b?void 0:b.FileType,I=(e=>{const{Product:t}=e;if(!t)return!1;const{ArtfileNeeded:s,NumberOfCxImages:a,ShippingMethod:n,SensariaProductId:r}=t;return s||!s&&0===a&&n&&r})(e),O=null===e||void 0===e||null===(v=e.Product)||void 0===v?void 0:v.NumberOfCxImages,P=s.workObject.attachments.filter((e=>e.metadata.lineItemId===N)),T=null===a||void 0===a?void 0:a.find((t=>t.variantSku===e.LineItem.SKU&&null!==t.shippingMethod&&null!==t.sensariaProductId)),A=!Z||(e=>{var t;const s=null===(t=e.LineItem.Properties)||void 0===t?void 0:t.find((e=>"parentId"===e.Name));return!!s&&d.has(s.Value)})(e),U=null===a||void 0===a?void 0:a.find((t=>t.variantSku===e.LineItem.SKU));return(0,i.jsx)(he.Z,{md:12,className:"mb-3",id:Z&&A?"child-".concat(y):k?"parent-".concat(S):null,children:(0,i.jsxs)(w.Z,{children:[(0,i.jsxs)(w.Z.Header,{className:"bg-brand text-white d-flex",children:[e.LineItem.Name.split("-")[0]," | ",(0,i.jsx)("b",{className:"ms-1",children:"Line Item ID:"}),e.LineItem.Id,(0,i.jsxs)("div",{className:"ms-auto",children:[!T&&U?(0,i.jsx)("span",{className:"p-1 rounded bg-danger ms-1",children:"IGNORED"}):U?null:(0,i.jsx)("span",{className:"p-1 rounded bg-danger ms-1",children:"SKU NOT FOUND"}),Z&&A?(0,i.jsxs)("span",{className:"bg-secondary rounded p-1 text-white ms-1 parent-child-label",onClick:()=>m("parent-".concat(y)),children:["Child Product ",(0,i.jsx)("span",{className:"child-parent-id",children:y})]}):Z&&!A&&(0,i.jsxs)("span",{className:"bg-danger rounded p-1 text-white ms-1",children:["Parent ID ",y," Not Found"]}),k&&!Z&&(0,i.jsxs)("span",{className:"bg-secondary rounded p-1 text-white ms-1 parent-child-label",onClick:()=>m("child-".concat(S)),children:["Parent Product ",S]}),I&&(O<1?(0,i.jsx)("span",{className:"bg-danger rounded p-1 text-white ms-1",children:"No CX Images Needed"}):(0,i.jsxs)(i.Fragment,{children:[(0,i.jsxs)("span",{className:"bg-warning rounded p-1 text-white ms-1",children:[O," CX Images Needed"]}),(0,i.jsxs)("span",{className:"bg-info rounded p-1 text-white ms-1",children:[O," Artfiles Needed"]})]}))]})]}),(0,i.jsx)(w.Z.Body,{children:(0,i.jsxs)(ue.Z,{children:[(0,i.jsxs)(he.Z,{md:3,children:[(0,i.jsx)(Me,{lineItem:e.LineItem,product:e.Product,productsCache:a,fetchWorkObject:r,productshippingprofiles:n,orderService:o,workObject:s}),(0,i.jsx)(qe,{workObject:s,lineItem:e.LineItem}),(0,i.jsx)(Ge,{properties:e.LineItem.properties})]}),I&&["cx","artfile","printfile"].map((e=>{const a=P.filter((t=>t.type===e));return(0,i.jsxs)(he.Z,{md:3,children:[(0,i.jsx)("p",{className:"fs-5 mb-1 text-capitalize",children:e}),"cx"===e&&(0,i.jsxs)(i.Fragment,{children:[a.map(((a,n)=>(0,i.jsx)(Xe,{cxPhotoIndex:n,workObjectId:f,attachment:a,fetchWorkObject:r,lineItemId:N,imageType:e,fileTypes:l.cxImageTypes,config:l,isAddonProduct:Z&&A,workObject:s,lineItemIndex:t},"".concat(a.id,"-").concat(n)))),Array.from({length:Math.max(0,O-a.length)}).map(((n,o)=>(0,i.jsx)("div",{className:"alert alert-light mb-4",children:(0,i.jsx)(_e,{cxPhotoIndex:o+a.length+1,lineItemId:N,workObjectId:f,imageType:e,fileTypes:l.cxImageTypes,fetchWorkObject:r,config:l,isReplacing:!1,isAddonProduct:Z&&A,workObject:s,lineItemIndex:t})},o)))]}),"artfile"===e&&(0,i.jsxs)(i.Fragment,{children:[a.map(((a,n)=>(0,i.jsx)(Xe,{cxPhotoIndex:n,workObjectId:f,attachment:a,fetchWorkObject:r,lineItemId:N,imageType:e,fileTypes:l.cxImageTypes,config:l,isAddonProduct:Z&&A,workObject:s,lineItemIndex:t},"".concat(a.id,"-").concat(n)))),Array.from({length:Math.max(0,O-a.length)}).map(((n,o)=>(0,i.jsx)("div",{className:"alert alert-light mb-4",children:(0,i.jsx)(_e,{cxPhotoIndex:o+a.length+1,lineItemId:N,workObjectId:f,imageType:e,fileTypes:l.cxImageTypes,fetchWorkObject:r,config:l,isReplacing:!1,isAddonProduct:Z&&A,workObject:s,lineItemIndex:t})},o)))]}),"printfile"===e&&(0,i.jsx)(Xe,{workObjectId:f,attachment:a[0],fetchWorkObject:r,lineItemId:N,imageType:e,fileTypes:c(e,C),config:l,isAddonProduct:Z,workObject:s,lineItemIndex:t},"".concat(t,"-").concat(e))]},"".concat(t,"-").concat(e))}))]})})]})},t)}))})]})}function $e(e){let{workObject:t,customer:s,shippingAddress:n,orderService:r,fetchWorkObject:l}=e;const[o,c]=(0,a.useState)({...n}),[d,m]=(0,a.useState)(!1),{hasPermission:u}=(0,a.useContext)(P),h=u("order:write")&&u("line_item:write");(0,a.useEffect)((()=>{if(d){const e=setTimeout((()=>{l(),m(!1)}),3e3);return()=>clearTimeout(e)}}),[d,l]);const x=e=>{const{name:t,value:s}=e.target;c((e=>({...e,[t]:s})))};return(0,i.jsx)(i.Fragment,{children:(0,i.jsxs)(he.Z,{md:6,sm:12,children:[(0,i.jsx)("div",{className:"text-start mb-2",children:(0,i.jsx)("h4",{className:"mb-0 ms-1",children:"Customer"})}),(0,i.jsx)(w.Z,{children:(0,i.jsxs)(w.Z.Body,{children:[d&&(0,i.jsx)(ve.Z,{variant:"success",children:"Shipping address updated successfully!"}),(0,i.jsxs)(ae.Z,{onSubmit:async e=>{e.preventDefault(),r.updateShippingAddress(t.workObject.shopifyOrderId,o).then((e=>{m(!0)})).catch((e=>{console.log(e)})).finally((()=>{}))},children:[(0,i.jsxs)(ue.Z,{children:[(0,i.jsxs)(ae.Z.Group,{className:"col-md-6 mb-2",children:[(0,i.jsx)(ae.Z.Label,{children:"First Name"}),(0,i.jsx)(ae.Z.Control,{name:"FirstName",value:(null===o||void 0===o?void 0:o.FirstName)||"",onChange:x,disabled:!h})]}),(0,i.jsxs)(ae.Z.Group,{className:"col-md-6 mb-2",children:[(0,i.jsx)(ae.Z.Label,{children:"Last Name"}),(0,i.jsx)(ae.Z.Control,{name:"LastName",value:(null===o||void 0===o?void 0:o.LastName)||"",onChange:x,disabled:!h})]}),(0,i.jsxs)(ae.Z.Group,{className:"col-12 mb-2",children:[(0,i.jsx)(ae.Z.Label,{children:"Email"}),(0,i.jsx)(ae.Z.Control,{name:"Email",defaultValue:(null===s||void 0===s?void 0:s.Email)||"",disabled:!h})]})]}),(0,i.jsxs)(ue.Z,{children:[(0,i.jsxs)(ae.Z.Group,{className:"col-md-6 mb-2",children:[(0,i.jsx)(ae.Z.Label,{children:"Address Line 1"}),(0,i.jsx)(ae.Z.Control,{name:"Address1",value:(null===o||void 0===o?void 0:o.Address1)||"",onChange:x,disabled:!h})]}),(0,i.jsxs)(ae.Z.Group,{className:"col-md-6 mb-2",children:[(0,i.jsx)(ae.Z.Label,{children:"Address Line 2"}),(0,i.jsx)(ae.Z.Control,{name:"address2",value:(null===o||void 0===o?void 0:o.Address2)||"",onChange:x,disabled:!h})]})]}),(0,i.jsxs)(ue.Z,{children:[(0,i.jsxs)(ae.Z.Group,{className:"col-md-6 mb-2",children:[(0,i.jsx)(ae.Z.Label,{children:"City"}),(0,i.jsx)(ae.Z.Control,{name:"City",value:(null===o||void 0===o?void 0:o.City)||"",onChange:x,disabled:!h})]}),(0,i.jsxs)(ae.Z.Group,{className:"col-md-6 mb-2",children:[(0,i.jsx)(ae.Z.Label,{children:"Province"}),(0,i.jsx)(ae.Z.Control,{name:"Province",value:(null===o||void 0===o?void 0:o.Province)||"",onChange:x,disabled:!h})]}),(0,i.jsxs)(ae.Z.Group,{className:"col-md-6 mb-2",children:[(0,i.jsx)(ae.Z.Label,{children:"Province Code"}),(0,i.jsx)(ae.Z.Control,{name:"ProvinceCode",value:(null===o||void 0===o?void 0:o.ProvinceCode)||"",onChange:x,disabled:!h})]}),(0,i.jsxs)(ae.Z.Group,{className:"col-md-6 mb-2",children:[(0,i.jsx)(ae.Z.Label,{children:"Country"}),(0,i.jsx)(ae.Z.Control,{name:"Country",value:(null===o||void 0===o?void 0:o.Country)||"",onChange:x,disabled:!h})]}),(0,i.jsxs)(ae.Z.Group,{className:"col-md-6 mb-2",children:[(0,i.jsx)(ae.Z.Label,{children:"Country Code"}),(0,i.jsx)(ae.Z.Control,{name:"CountryCode",value:(null===o||void 0===o?void 0:o.CountryCode)||"",onChange:x,disabled:!h})]}),(0,i.jsxs)(ae.Z.Group,{className:"col-md-6 mb-2",children:[(0,i.jsx)(ae.Z.Label,{children:"Zip"}),(0,i.jsx)(ae.Z.Control,{name:"Zip",value:(null===o||void 0===o?void 0:o.Zip)||"",onChange:x,disabled:!h})]})]}),(0,i.jsx)("div",{className:"text-end",children:(0,i.jsx)(b.Z,{className:"btn btn-brand",type:"submit",disabled:!h,children:"Save"})})]})]})})]})})}var Qe=s(6050);function et(e){let{comments:t,orderId:s,fetchWorkObject:n}=e;const[r,l]=(0,a.useState)({}),[o,c]=(0,a.useState)(""),[d,m]=(0,a.useState)(""),[u,h]=(0,a.useState)({}),{commentsService:x,getUserById:j}=(0,a.useContext)(W),[g,p]=(0,a.useState)({}),N=(0,a.useRef)({});(0,a.useEffect)((()=>{t.forEach((e=>{N.current[e.id]=(0,a.createRef)(),j(e.userId).then((t=>{p((s=>({...s,[e.userId]:t})))}))}))}),[t,j]);const w=e=>{x.newComment(s,e).then((()=>{n(),m("")})).catch((e=>{m("Failed to post a new comment. Please try again.")})).finally((()=>h((e=>({...e,newComment:!1})))))},Z=e=>{l((t=>({...t,[e]:!t[e]})))},k=function(e){let t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:0;return e.map((e=>(N.current[e.id]||(N.current[e.id]=(0,a.createRef)()),(0,i.jsxs)("details",{open:!0,className:"comment",id:"comment-".concat(e.id),style:{marginLeft:20*t},children:[(0,i.jsx)("a",{href:"#comment-".concat(e.id),className:"comment-border-link",children:(0,i.jsxs)("span",{className:"sr-only",children:["Jump to comment-",e.id]})}),(0,i.jsx)("summary",{children:(0,i.jsx)("div",{className:"comment-heading",children:(0,i.jsx)("div",{className:"comment-info",children:(0,i.jsxs)("div",{className:"flex-shrink-0 me-2 position-relative comment-user-image",children:[(0,i.jsx)(v.G,{icon:f.ILF}),(0,i.jsxs)("span",{className:"comment-author",children:[" ",g[e.userId]||"Loading..."]}),(0,i.jsxs)("span",{className:"m-0",children:[" ",Ae(e.timestamp)]})]})})})}),(0,i.jsx)("div",{className:"comment-body",children:(0,i.jsxs)("div",{className:"border p-2 rounded shadow-sm border-light",children:[(0,i.jsx)("p",{className:"rounded-4 bg-light p-2 ps-3",children:e.message}),(0,i.jsxs)("div",{className:"text-end",children:[(0,i.jsxs)(b.Z,{variant:"",className:"".concat(r[e.id]?"fade hide btn-sm btn-brand":"fade show btn-sm btn-brand"),onClick:()=>Z(e.id),children:[(0,i.jsx)(v.G,{icon:f.Mzg})," Reply"]}),(0,i.jsxs)(b.Z,{variant:"danger",className:"".concat(r[e.id]?"fade hide btn-sm ms-2":"fade show btn-sm ms-2"),onClick:()=>{return t=e.id,void x.deleteComment(s,t).then((()=>{n(),m("")})).catch((e=>{m("Failed to delete the comment. Please try again.")}));var t},children:[(0,i.jsx)(v.G,{icon:f.$aW})," Delete"]})]}),u[e.id]&&(0,i.jsx)(le,{message:"Posting your reply...",variant:"dark",size:"sm"}),(0,i.jsx)(Qe.Z,{in:r[e.id],children:(0,i.jsxs)("div",{className:"reply-form",children:[(0,i.jsxs)(ae.Z.Floating,{className:"mb-2",children:[(0,i.jsx)(ae.Z.Control,{as:"textarea",ref:N.current[e.id],className:"form-control h-auto",placeholder:"Your reply...",rows:"4"}),(0,i.jsx)("label",{htmlFor:"reply-comment-textarea-".concat(e.id),children:"Your reply..."})]}),(0,i.jsxs)("div",{className:"d-flex justify-content-end align-items-center mt-2",children:[(0,i.jsxs)(b.Z,{variant:"",className:"btn-sm me-2 btn-brand",onClick:()=>(e=>{const t=N.current[e].current.value;t.trim()&&(h((t=>({...t,[e]:!0}))),x.replyToComment(s,t,e).then((()=>{n(),m(""),Z(e)})).catch((e=>{m("Failed to post a reply. Please try again.")})).finally((()=>h((t=>({...t,[e]:!1}))))))})(e.id),disabled:u[e.id],children:[(0,i.jsx)(v.G,{icon:f.Mzg})," Comment"]}),(0,i.jsx)(b.Z,{variant:"secondary",className:"btn-sm",onClick:()=>Z(e.id),children:"Cancel"})]})]})})]})}),e.childComments&&(0,i.jsx)("div",{className:"replies",children:k(e.childComments,t+1)})]},"comment-".concat(e.id)))))};return(0,i.jsxs)(i.Fragment,{children:[d&&(0,i.jsx)(ve.Z,{variant:"danger",onClose:()=>m(""),dismissible:!0,children:d}),(0,i.jsxs)("div",{style:{maxHeight:"600px",overflow:"hidden",display:"flex",flexDirection:"column"},children:[(0,i.jsxs)("div",{className:"comment-thread",style:{overflowY:"auto",flexGrow:1},children:[u.newComment&&(0,i.jsx)(le,{message:"Posting your comment...",variant:"dark",size:"sm"}),t&&t.length>0&&k(t)]}),(0,i.jsxs)(Ie.Z,{children:[(0,i.jsx)(ae.Z.Control,{as:"textarea",className:"rounded-4 rounded-end-0",placeholder:"Add a new comment...",value:o,onChange:e=>{c(e.target.value)}}),(0,i.jsx)(b.Z,{variant:"",className:"rounded-4 rounded-start-0 btn-brand",onClick:()=>{o.trim()&&(h({newComment:!0}),w(o),c(""))},disabled:u.newComment,children:"Post"})]})]})]})}const tt=e=>{let{activityData:t}=e;const{getUserById:s}=(0,a.useContext)(W),[n,r]=(0,a.useState)(!0),[l,o]=(0,a.useState)({}),[c,d]=(0,a.useState)({}),[m,u]=(0,a.useState)(!1),[h,x]=(0,a.useState)(!1),[g,p]=(0,a.useState)(0),N=(0,a.useRef)(null),w=()=>{N.current.scrollTop>0?x(!0):x(!1)};(0,a.useEffect)((()=>{const e={},a=new Set;let n=0;t.results.forEach((t=>{t.changes.forEach((s=>{n++;const r="".concat(t.id,"-").concat(s.id);e[r]=!0,"assignedTo"!==s.field&&"userId"!==s.field&&"assignedToPrevious"!==s.field||(s.currentValue&&a.add(s.currentValue),s.modifiedValue&&a.add(s.modifiedValue))})),t.userId&&a.add(t.userId)})),p(n),o(e),(async()=>{const e={};for(const t of a){const a=await s(t);e[t]=a||"Unavailable"}d(e)})()}),[t,s]),(0,a.useEffect)((()=>{const e=N.current;return e.addEventListener("scroll",w),()=>e.removeEventListener("scroll",w)}),[]);const Z=t.results.filter((e=>"Transition"!==e.auditType.name)).sort(((e,t)=>{const s=new Date(e.timestamp),a=new Date(t.timestamp);return n?s-a:a-s}));return(0,i.jsxs)(j.Z,{fluid:!0,style:{maxHeight:"500px",overflowY:"auto"},ref:N,children:[(0,i.jsxs)("div",{className:"d-flex sticky-top bg-white w-100 shadow-sm p-2 rounded-bottom",children:[(0,i.jsx)("div",{className:"flex-grow-1",children:(0,i.jsxs)("div",{className:"bg-light text-dark d-inline-block me-2 p-2 rounded",children:[(0,i.jsx)("strong",{className:"mb-0",children:"Events"})," ",(0,i.jsx)(k.Z,{className:"bg-dark text-white d-inline-block",children:g})]})}),(0,i.jsxs)("div",{className:"",children:[(0,i.jsxs)(b.Z,{variant:"light me-2",onClick:()=>r(!n),children:[(0,i.jsx)(v.G,{icon:n?f.MdH:f.J$0})," Sort"]}),(0,i.jsxs)(b.Z,{variant:"light",onClick:()=>{const e={};Object.keys(l).forEach((t=>{e[t]=m})),u(!m),o(e)},children:[(0,i.jsx)(v.G,{icon:m?f.Mdf:f.Aq})," Toggle All"]})]})]}),(0,i.jsx)("ul",{className:"timeline",children:Z.map(((e,t)=>e.changes.map(((t,s)=>{const a=(e=>{const t=/^(.+)\[(\d+)\](\..+)?$/;let s={type:"",activity:"",oldValue:e.currentValue,newValue:e.modifiedValue};const a=e=>e?c[e]||"Fetching...":"System";if(t.test(e.field)){const n=t.exec(e.field),r=n[1],l=n[2],i=n[3]?n[3].substring(1):"";switch(s.type=i||r,s.activity="".concat(i||r," changed"),i){case"sourceUser":case"assignedTo":case"designatedPrintFileDesigner":s.oldValue=a(e.currentValue),s.newValue=a(e.modifiedValue);break;case"originalFileName":s.type="fileName",s.activity="File name changed";break;case"metadata.lineItemId":case"LineItem.Name":case"LineItem.VariantTitle":case"LineItem.VariantId":case"LineItem.SKU":case"fileSize":break;default:i||(s.activity="".concat(r," at index ").concat(l," changed"),"comments"===r?(s.activity="New comment",s.type="comment",s.oldValue=null,s.newValue=null):s.type="arrayChange")}}else switch(s.type=e.field,s.activity="".concat(e.field," changed"),e.field){case"status":s.oldValue=(0,i.jsx)(X,{status:parseInt(e.currentValue)}),s.newValue=(0,i.jsx)(X,{status:parseInt(e.modifiedValue)});break;case"shopifyOrderId":case"orderName":case"orderNumber":case"customerEmail":case"lastModified":default:break;case"sourceUser":case"assignedTo":case"assignedToPrevious":case"designatedPrintFileDesigner":s.oldValue=a(e.currentValue),s.newValue=a(e.modifiedValue)}return s})(t),n="".concat(e.id,"-").concat(t.id);return(0,i.jsxs)("li",{children:[(0,i.jsx)("div",{className:"timeline-icon",children:(0,i.jsx)("div",{children:"\xa0"})}),(0,i.jsxs)("div",{className:"timeline-body bg-light border border-dark shadow-sm",children:[(0,i.jsx)("div",{className:"position-absolute end-0 top-0",children:(0,i.jsx)(b.Z,{className:"bg-transparent text-muted border-0 p-2",onClick:()=>(e=>{o((t=>({...t,[e]:!t[e]})))})(n),children:(0,i.jsx)(v.G,{icon:l[n]?f.Aq:f.Mdf})})}),(0,i.jsx)("div",{className:"timeline-header",children:(0,i.jsxs)("span",{className:"username",children:[(0,i.jsx)(k.Z,{className:"bg-dark text-white",children:a.activity}),(0,i.jsxs)("div",{className:"d-flex justify-content-start flex-column",children:[(0,i.jsxs)("strong",{children:["User: ",(0,i.jsx)("span",{className:"text-muted",children:e.userId?c[e.userId]||"Fetching...":"System"})]}),(0,i.jsxs)("strong",{children:["On: ",(0,i.jsx)("span",{className:"date text-muted",children:Q(e.timestamp,!1,!1)})]})]})]})}),(0,i.jsxs)("div",{className:"timeline-content ".concat(l[n]?"":"open"),children:[(0,i.jsx)("hr",{}),(0,i.jsxs)("p",{className:"mb-0",children:[(0,i.jsx)("strong",{children:"User:"})," ",e.userId?c[e.userId]||"Fetching...":"System"]}),(0,i.jsxs)("div",{children:[(0,i.jsxs)("p",{children:[(0,i.jsx)("strong",{children:"Activity:"})," ",a.activity]}),a.oldValue&&(0,i.jsxs)("p",{children:[(0,i.jsx)("strong",{children:"Previous Value:"})," ",a.oldValue]}),a.newValue&&(0,i.jsxs)("p",{children:[(0,i.jsx)("strong",{children:"Updated Value:"})," ",a.newValue]})]})]})]})]},"".concat(n))}))))}),h&&(0,i.jsx)(b.Z,{variant:"dark",style:{position:"absolute",right:"3rem",bottom:"1rem",zIndex:1},onClick:()=>{N.current.scrollTo({top:0,behavior:"smooth"})},children:(0,i.jsx)(v.G,{icon:f.FPD})})]})};function st(){const{orderId:e}=(0,r.UO)(),{config:t}=(0,a.useContext)(d),{hasPermission:s,user:n}=(0,a.useContext)(P),{orderService:l,lookupService:o,getProductsCache:c,productscache:m,getProductShippingProfiles:u,productshippingprofiles:h}=(0,a.useContext)(W),[x,j]=(0,a.useState)(!0),[g,p]=(0,a.useState)(null),[b,v]=(0,a.useState)(!0),[f,N]=(0,a.useState)(null);return(0,a.useEffect)((()=>{b&&(v(!1),l.getDetails(e).then((e=>{p(e.data)}),(e=>{e.response?404===e.response.status?N("Order not found"):N("".concat(e.response.data.Message.replace("workobject","order")," You're seeing this message because you made a change that affected this order's status.")):N(e),p(null)})).finally((()=>{j(!1)})),c().then((e=>{})).catch((e=>{console.log(e)})),u().then((e=>{})).catch((e=>{console.log(e)})))}),[e,l,n,o,m,b,h,c,u]),(0,i.jsxs)(i.Fragment,{children:[x&&(0,i.jsx)(le,{variant:"dark"}),!x&&null===g&&(0,i.jsx)("div",{className:"alert alert-warning",role:"alert",children:f?(0,i.jsx)(i.Fragment,{children:f}):(0,i.jsxs)(i.Fragment,{children:["Failed to locate order '",e,"' or you do not have permission to view this order."]})}),!x&&null!==g&&(0,i.jsxs)(i.Fragment,{children:[(0,i.jsx)(Pe,{workObject:g,orderService:l,hasPermission:s,user:n,fetchWorkObject:()=>v(!0)}),(0,i.jsx)(Te,{workObject:g.workObject}),(0,i.jsx)(Ue,{workObject:g.workObject}),(0,i.jsx)(Je,{config:t,orderId:e,workObject:g,orderService:l,setIsLoading:j,productsCache:m,productshippingprofiles:h,fetchWorkObject:()=>v(!0)}),(0,i.jsxs)(ue.Z,{children:[s("order:read")?(0,i.jsx)($e,{workObject:g,orderService:l,fetchWorkObject:()=>v(!0),customer:g.workObject.metadata.customer,shippingAddress:g.workObject.metadata.shippingAddress}):null,(0,i.jsxs)(he.Z,{md:6,sm:12,children:[(0,i.jsx)("div",{className:"text-start mb-2",children:(0,i.jsx)("h4",{className:"mb-0 ms-1",children:"Comments/Activity"})}),(0,i.jsx)(w.Z,{children:(0,i.jsx)(w.Z.Body,{children:(0,i.jsxs)(we.Z,{defaultActiveKey:"comments",id:"comments-activity-tabs",className:"mb-3",children:[(0,i.jsx)(Ze.Z,{eventKey:"comments",title:"Comments",children:(0,i.jsx)(et,{orderId:e,comments:g.comments,fetchWorkObject:()=>v(!0)})}),(0,i.jsx)(Ze.Z,{eventKey:"activity",title:"Activity",children:(0,i.jsx)(tt,{activityData:g.audits})})]})})})]})]})]})]})}function at(){const{distributionService:e,averageDailyOrderCaches:t,getUserById:s}=(0,a.useContext)(W),[n,r]=(0,a.useState)(null),[l,o]=(0,a.useState)({}),[c,d]=(0,a.useState)("artfile"),[m,u]=(0,a.useState)(null),[x,j]=(0,a.useState)(""),[g,N]=(0,a.useState)(0),[w,Z]=(0,a.useState)(0),k=(0,a.useCallback)(((t,a)=>{e.getUsersCapacity(t,a).then((e=>{r(e.data);const t=e.data.map((e=>{let{userId:t}=e;return s(t).then((e=>[t,e]))})),a=e.data.reduce(((e,t)=>e+t.distribution),0);N(a);const n=e.data.reduce(((e,t)=>e+t.averageAssignedPerDay),0);Z(n),Promise.all(t).then((e=>{o((t=>({...t,...Object.fromEntries(e)})))}))})).catch((e=>{console.log(e)}))}),[e,s]);(0,a.useEffect)((()=>{k("artfile",t)}),[k,t]);let y="Healthy Capacity",S="success",C="Distribution is healthy";return g>w?(y="Over Capacity",S="danger",C="Distribution is over capacity some users will not get assigned order in a timely manner."):g/w>=.8&&(y="Near Capacity",S="warning",C="Distribution is nearing capacity please adjust distribution to avoid over capacity and users not getting assigned orders in a timely manner."),(0,i.jsxs)(i.Fragment,{children:[(0,i.jsxs)("div",{className:"d-flex flex-column flex-md-row justify-content-center",children:[null!==g&&(0,i.jsxs)("h6",{className:"me-2 mb-1 border p-1 rounded mb-md-0",children:["Daily distribution ",(0,i.jsx)("span",{className:"badge bg-dark",children:g})]}),null!==w&&(0,i.jsxs)("h6",{className:"me-2 mt-md-0 border p-1 rounded mb-1 mb-md-0",children:[" Daily average assigned orders ",(0,i.jsx)("span",{className:"badge bg-dark",children:w})]}),(0,i.jsx)("div",{className:"p-1",children:(0,i.jsx)(p.Z,{placement:"right",overlay:(0,i.jsx)(h.Z,{id:"tooltip-top",children:C}),children:(0,i.jsxs)(ve.Z,{variant:S,className:"mb-0 ps-1 pe-1 pt-0 pb-0 fw-bold mt-md-0 distribution-alert",children:[y," ",(0,i.jsx)(v.G,{icon:f.DBf})]})})})]}),(0,i.jsx)("hr",{}),(0,i.jsx)(ue.Z,{children:(0,i.jsx)(he.Z,{children:(0,i.jsxs)("div",{className:"d-flex justify-content-start mb-3",children:[(0,i.jsx)(b.Z,{variant:"artfile"===c?"dark":"light",className:"me-2",onClick:()=>{d("artfile"),k("artfile",t)},children:"Art File"}),(0,i.jsx)(b.Z,{variant:"printfile"===c?"dark":"light",onClick:()=>{d("printfile"),k("printfile",t)},children:"Print File"})]})})}),n&&(0,i.jsxs)(i.Fragment,{children:[(0,i.jsx)("h5",{children:"artfile"===c?"Art File Distribution":"Print File Distribution"}),(0,i.jsxs)(V.Z,{striped:!0,bordered:!0,hover:!0,className:"rounded-table",children:[(0,i.jsx)("thead",{children:(0,i.jsxs)("tr",{children:[(0,i.jsx)("th",{children:"User"}),(0,i.jsx)("th",{children:"Distribution"}),(0,i.jsx)("th",{children:"Orders Per Day"})]})}),(0,i.jsx)("tbody",{children:n.map((s=>(0,i.jsxs)("tr",{children:[(0,i.jsx)("td",{children:l[s.userId]}),(0,i.jsx)("td",{children:m===s.userId?(0,i.jsxs)("div",{className:"d-flex",children:[(0,i.jsx)(ae.Z.Control,{type:"text",value:x,onChange:e=>j(e.target.value)}),(0,i.jsx)(b.Z,{variant:"dark btn-sm",className:"ms-2",onClick:()=>{return a=s.userId,void e.setUserDistribution(a,c,x).then((()=>{u(null),k(c,t)})).catch((e=>{console.log(e)}));var a},children:(0,i.jsx)(v.G,{size:"sm",icon:f.r6l})})]}):(0,i.jsxs)(i.Fragment,{children:[s.distribution,(0,i.jsx)(b.Z,{onClick:()=>{return e=s.userId,t=s.distribution,u(e),void j(t);var e,t},variant:"dark btn-sm",className:"ms-2",children:(0,i.jsx)(v.G,{size:"sm",icon:f.Xcf})})]})}),(0,i.jsx)("td",{children:s.averageAssignedPerDay})]},s.userId)))})]})]})]})}var nt=s(7969),rt=s(2228);function lt(){const{attachmentService:e}=(0,a.useContext)(W),{hasPermission:t}=(0,a.useContext)(P),[s,n]=(0,a.useState)(!1),[r,l]=(0,a.useState)([]),[o,c]=(0,a.useState)({}),[d,m]=(0,a.useState)(!1),[u,h]=(0,a.useState)(!1),[x,j]=(0,a.useState)(!1),[g,p]=(0,a.useState)(0),[N,w]=(0,a.useState)(0),[Z,y]=(0,a.useState)(0),[S,C]=(0,a.useState)(null),[I,O]=(0,a.useState)(""),[T,A]=(0,a.useState)((()=>{const e=localStorage.getItem("uploadRegion");localStorage.getItem("userSelectedRegion"),localStorage.getItem("lastRegionCheck");return e||"us"})),[U,F]=(0,a.useState)((()=>"true"===localStorage.getItem("userSelectedRegion"))),L=t("image_artfile:write"),D=t("image_printfile:write"),M=L?"artfile":D?"printfile":null,[E,G]=(0,a.useState)(M),B=(0,a.useRef)(),z=()=>{l([]),c({}),n(!1),h(!1),C(null),O("")},H=async function(e){let t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:"";return new Promise((s=>{if(e.isFile)e.file((e=>{e.fullPath=t+e.name,s(e)}));else if(e.isDirectory){e.createReader().readEntries((async e=>{const a=[];for(const s of e){const e="".concat(t).concat(s.name,"/"),n=await H(s,e);a.push(n)}s(a.flat())}))}}))},K=e=>{const t=[...r,...e];l(t),p(t.length)};(0,a.useEffect)((()=>{let e;return x&&S?e=setInterval((()=>{const e=new Date,t=Math.floor((e-S)/1e3),s=Math.floor(t/60),a=t%60;O("".concat(s?"".concat(s," minutes"):""," ").concat(a," seconds"))}),1e3):!x&&S&&clearInterval(e),()=>{e&&clearInterval(e)}}),[x,S]);const R=g?Z/g*100:0;return(0,a.useEffect)((()=>{(async()=>{if(U)return;const e=localStorage.getItem("lastRegionCheck"),t=(new Date).getTime();if(!(e&&t-parseInt(e)<864e5))try{var s;const e=await fetch("https://geoip.prod.graduatesapi.com/api/geolocation",{mode:"cors",headers:{Accept:"application/json","Access-Control-Allow-Origin":"*"}});if(!e.ok)throw new Error("Network response was not ok");const a=null!==(s=(await e.json()).time_zone)&&void 0!==s&&s.includes("Asia")?"asia":"us";A(a),localStorage.setItem("uploadRegion",a),localStorage.setItem("userSelectedRegion","false"),localStorage.setItem("lastRegionCheck",t.toString())}catch(a){console.error("Error detecting region:",a),A("us"),localStorage.setItem("uploadRegion","us"),localStorage.setItem("lastRegionCheck",t.toString())}})()}),[U]),(0,i.jsx)(i.Fragment,{children:(L||D)&&(0,i.jsxs)(i.Fragment,{children:[(0,i.jsx)(b.Z,{className:"rounded-circle bulk-upload-button btn-brand shadow ",onClick:()=>n(!0),children:(0,i.jsx)(v.G,{icon:f.KN3})}),(0,i.jsxs)(ge.Z,{show:s,onHide:z,size:"xl",children:[(0,i.jsx)(ge.Z.Header,{closeButton:!0,children:(0,i.jsx)(ge.Z.Title,{children:"Bulk Upload"})}),(0,i.jsxs)(ge.Z.Body,{children:[(0,i.jsxs)("div",{className:"text-center mb-3",children:[(0,i.jsxs)(nt.Z,{type:"radio",name:"fileType",size:"sm",defaultValue:E,onChange:e=>G(e),children:[L&&(0,i.jsx)(rt.Z,{id:"tbg-artfile",value:"artfile",variant:"artfile"===E?"dark":"light",children:"Art File"}),D&&(0,i.jsx)(rt.Z,{id:"tbg-printfile",value:"printfile",variant:"printfile"===E?"dark":"light",children:"Print File"})]}),(0,i.jsxs)("div",{className:"mt-2",children:["You're uploading ",(0,i.jsx)(k.Z,{className:"bg-secondary",children:E}),(0,i.jsx)("hr",{}),(0,i.jsxs)(k.Z,{className:"bg-dark ms-2",children:["Total Files: ",g]})," |",(0,i.jsxs)(k.Z,{className:"bg-danger ms-2",children:["Failed: ",N]})," |",(0,i.jsxs)(k.Z,{className:"bg-success ms-2",children:["Succeeded: ",Z]})]}),(0,i.jsx)(pe.Z,{variant:"success",now:R,label:"".concat(Math.round(R),"%"),className:"mt-3"}),(0,i.jsx)("div",{className:"mt-2",children:I&&"Elapsed Time: ".concat(I)})]}),(0,i.jsxs)("div",{className:"text-center mb-3",children:[(0,i.jsxs)(nt.Z,{type:"radio",name:"region",size:"sm",value:T,onChange:e=>{A(e),F(!0),localStorage.setItem("uploadRegion",e),localStorage.setItem("userSelectedRegion","true")},children:[(0,i.jsx)(rt.Z,{id:"tbg-us",value:"us",variant:"us"===T?"dark":"light",children:"US Region"}),(0,i.jsx)(rt.Z,{id:"tbg-asia",value:"asia",variant:"asia"===T?"dark":"light",children:"Asia Region"})]}),(0,i.jsxs)("div",{className:"mt-2",children:["Selected Region: ",(0,i.jsx)(k.Z,{className:"bg-secondary",children:T.toUpperCase()})]})]}),(0,i.jsx)("div",{className:"bulkuploader rounded ".concat(d?"over":""),onDragOver:e=>{e.preventDefault(),m(!0)},onDragLeave:()=>{m(!1)},onDrop:async e=>{e.preventDefault(),m(!1);const t=e.dataTransfer.items;let s=[];for(const n of t){const e=n.webkitGetAsEntry?n.webkitGetAsEntry():null;e?s.push(e):"file"===n.kind&&s.push(n.getAsFile())}let a=[];for(const n of s)if(n.isFile||n instanceof File)if(n instanceof File)a.push(n);else{const e=new Promise((e=>{n.file((t=>{e(t)}))})),t=await e;a.push(t)}else if(n.isDirectory){const e=await H(n);a=[...a,...e]}a=a.filter((e=>"image/jpeg"===e.type||"image/png"===e.type)),K(a)},children:d?"Release to drop files":"Drag & Drop Files Here"}),(0,i.jsxs)("div",{className:"text-center mt-2",children:[(0,i.jsx)("p",{className:"mb-0",children:"or"}),(0,i.jsx)(b.Z,{variant:"outline-dark",className:"mt-2",onClick:()=>{B.current.click()},children:"Select Files"})]}),(0,i.jsx)("input",{ref:B,id:"fileUpload",type:"file",multiple:!0,accept:"image/jpeg, image/png",onChange:e=>K(Array.from(e.target.files)),style:{display:"none"}}),r.length>0&&(0,i.jsxs)("div",{className:"uploaded-files-list mt-2 text-center bg-light border border-secondary rounded pb-0 shadow-sm",style:{maxHeight:"400px",overflowY:"auto"},children:[(0,i.jsx)("p",{className:"mt-3 mb-0",children:"Files to be uploaded:"}),(0,i.jsx)("hr",{}),r.map((e=>{var t,s,a,n,r,l,c;return(0,i.jsxs)("div",{children:[e.name," -",(0,i.jsx)(k.Z,{className:"ms-1 ".concat("success"===(null===(t=o[e.name])||void 0===t?void 0:t.status)?"bg-success":"failure"===(null===(s=o[e.name])||void 0===s?void 0:s.status)?"bg-danger":"bg-warning"),children:(null===(a=o[e.name])||void 0===a?void 0:a.status)||"pending"}),(null===(n=o[e.name])||void 0===n?void 0:n.timestamp)&&(0,i.jsxs)("span",{className:"text-muted ms-2",children:["(",null===(r=o[e.name])||void 0===r?void 0:r.timestamp,")"]}),"failure"===(null===(l=o[e.name])||void 0===l?void 0:l.status)&&(0,i.jsxs)("span",{className:"text-danger ms-2",children:["(",null===(c=o[e.name])||void 0===c?void 0:c.message,")"]})]},e.name)})),(0,i.jsx)("div",{className:"sticky-bottom text-center mt-3 mb-0 w-100",children:u?(0,i.jsx)(b.Z,{variant:"dark",className:"shadow-sm w-100 rounded-0",onClick:()=>{const e=new Date,t="".concat(e.getMonth()+1,"-").concat(e.getDate(),"-").concat(e.getFullYear(),"-").concat(e.getHours(),"-").concat(e.getMinutes(),"-bulk-upload-report.csv"),s="data:text/csv;charset=utf-8,File Name,Status,Error Message,Timestamp\n"+Object.keys(o).map((e=>"".concat(e,",").concat(o[e].status,",").concat(o[e].message||"",",").concat(o[e].timestamp||""))).join("\n"),a=encodeURI(s),n=document.createElement("a");n.setAttribute("href",a),n.setAttribute("download",t),n.click()},children:"Export List"}):(0,i.jsx)(b.Z,{variant:"dark",className:"shadow-sm w-100 rounded-0",onClick:async()=>{j(!0),C(new Date);for(const l of r){const r=new Date,i="".concat(r.getMonth()+1,"/").concat(r.getDate(),"/").concat(r.getFullYear()," - ").concat(r.getHours()%12||12,":").concat(String(r.getMinutes()).padStart(2,"0")," ").concat(r.getHours()>=12?"PM":"AM"," EST");try{await e.bulkUploadAttachment(l,E,T),c((e=>({...e,[l.name]:{status:"success",message:"",timestamp:i}}))),y((e=>e+1))}catch(n){var t,s,a;const e=null!==(t=null===n||void 0===n||null===(s=n.response)||void 0===s||null===(a=s.data)||void 0===a?void 0:a.Message)&&void 0!==t?t:"Unknown error";c((t=>({...t,[l.name]:{status:"failure",message:e,timestamp:i}}))),w((e=>e+1))}}h(!0),j(!1)},children:x?(0,i.jsx)(le,{variant:"light"}):(0,i.jsxs)(i.Fragment,{children:[(0,i.jsx)(v.G,{icon:f.KN3})," Confirm and Upload"]})})})]})]}),(0,i.jsx)(ge.Z.Footer,{children:(0,i.jsx)(b.Z,{variant:"secondary",className:"shadow",onClick:z,children:"Close"})})]})]})})}function it(e){let{show:t,handleClose:s,sku:n,handleEditChange:r,updateSku:l,productshippingprofiles:o,errorMessage:c,handleIgnoreSku:d}=e;const[m,u]=(0,a.useState)(!1),h=()=>{u(!1)};return(0,i.jsxs)(ge.Z,{show:t,onHide:s,children:[(0,i.jsx)(ge.Z.Header,{closeButton:!0,children:(0,i.jsx)(ge.Z.Title,{children:"Edit SKU"})}),(0,i.jsxs)(ge.Z.Body,{children:[c&&(0,i.jsx)("p",{className:"text-danger me-auto",children:c}),(0,i.jsxs)(ae.Z,{children:[(0,i.jsxs)(ae.Z.Group,{className:"mb-3",children:[(0,i.jsx)(ae.Z.Label,{children:"Title"}),(0,i.jsx)(ae.Z.Control,{type:"text",name:"title",value:n.title,onChange:r})]}),(0,i.jsxs)(ae.Z.Group,{className:"mb-3",children:[(0,i.jsx)(ae.Z.Label,{children:"Handle"}),(0,i.jsx)(ae.Z.Control,{type:"text",name:"handle",value:n.handle.replace(/\s/g,"-"),onChange:r})]}),(0,i.jsxs)(ae.Z.Group,{className:"mb-3",children:[(0,i.jsx)(ae.Z.Label,{children:"Option 1"}),(0,i.jsx)(ae.Z.Control,{type:"text",name:"option1",value:n.option1,onChange:r})]}),(0,i.jsxs)(ae.Z.Group,{className:"mb-3",children:[(0,i.jsx)(ae.Z.Label,{children:"Option 2"}),(0,i.jsx)(ae.Z.Control,{type:"text",name:"option2",value:n.option2,onChange:r})]}),(0,i.jsxs)(ae.Z.Group,{className:"mb-3",children:[(0,i.jsx)(ae.Z.Label,{children:"Option 3"}),(0,i.jsx)(ae.Z.Control,{type:"text",name:"option3",value:n.option3,onChange:r})]}),(0,i.jsxs)(ae.Z.Group,{className:"mb-3",children:[(0,i.jsx)(ae.Z.Label,{children:"Sensaria PID"}),(0,i.jsx)(ae.Z.Control,{type:"number",name:"sensariaProductId",value:n.sensariaProductId||"",onChange:r})]}),(0,i.jsxs)(ae.Z.Group,{className:"mb-3",children:[(0,i.jsx)(ae.Z.Label,{children:"Shipping Method"}),(0,i.jsxs)(ae.Z.Select,{name:"shippingMethod",value:n.shippingMethod||"",onChange:r,children:[(0,i.jsx)("option",{value:null,children:"NONE"}),o.map((e=>(0,i.jsxs)("option",{value:e.id,children:[e.method," (",e.id,")"]},e.id)))]})]}),(0,i.jsxs)(ae.Z.Group,{className:"mb-3",children:[(0,i.jsx)(ae.Z.Label,{children:"Artfile Needed"}),(0,i.jsx)(ae.Z.Check,{type:"checkbox",name:"artfileNeeded",checked:n.artfileNeeded,onChange:r})]}),(0,i.jsxs)(ae.Z.Group,{className:"mb-3",children:[(0,i.jsx)(ae.Z.Label,{children:"File Type"}),(0,i.jsxs)(ae.Z.Select,{name:"fileType",value:n.fileType||"",onChange:r,children:[(0,i.jsx)("option",{value:null,children:"NONE"}),(0,i.jsx)("option",{value:".jpg",children:".jpg"}),(0,i.jsx)("option",{value:".png",children:".png"})]})]}),(0,i.jsxs)(ae.Z.Group,{className:"mb-3",children:[(0,i.jsx)(ae.Z.Label,{children:"Number of CX Images"}),(0,i.jsx)(ae.Z.Control,{type:"number",name:"numberOfCxImages",value:n.numberOfCxImages||0,onChange:r})]})]})]}),(0,i.jsxs)(ge.Z.Footer,{children:[c&&(0,i.jsx)("p",{className:"text-danger me-auto",children:c}),(0,i.jsx)(b.Z,{variant:"secondary",onClick:s,children:"Close"}),(0,i.jsx)(b.Z,{className:"btn-brand",onClick:l,children:"Save Changes"}),(0,i.jsx)(b.Z,{variant:"danger",onClick:()=>{u(!0)},children:"Ignore SKU"})]}),(0,i.jsxs)(ge.Z,{show:m,onHide:h,children:[(0,i.jsx)(ge.Z.Header,{closeButton:!0,className:"bg-danger text-white",children:(0,i.jsx)(ge.Z.Title,{children:"Confirm Ignore SKU"})}),(0,i.jsx)(ge.Z.Body,{className:"bg-danger text-white",children:(0,i.jsx)("p",{children:"This action can affect many orders. Are you sure you want to ignore this SKU?"})}),(0,i.jsxs)(ge.Z.Footer,{className:"bg-danger text-white",children:[(0,i.jsx)(b.Z,{variant:"secondary",onClick:h,children:"Cancel"}),(0,i.jsx)(b.Z,{variant:"danger",className:"border border-white",onClick:()=>{u(!1),d()},children:"Confirm Ignore"})]})]})]})}function ot(e){let{show:t,handleClose:s,sku:a,deleteSku:n,deletionStatus:r,deletionMessage:l,errorMessage:o}=e;return(0,i.jsxs)(ge.Z,{show:t,onHide:s,children:[(0,i.jsx)(ge.Z.Header,{closeButton:!0,children:(0,i.jsx)(ge.Z.Title,{children:"Delete SKU"})}),(0,i.jsxs)(ge.Z.Body,{children:[o&&(0,i.jsx)("p",{className:"text-danger me-auto",children:o}),a&&!r&&(0,i.jsxs)("div",{children:[(0,i.jsxs)("p",{children:["Are you sure you want to delete the SKU: ",(0,i.jsx)(k.Z,{pill:!0,bg:"dark",children:a.variantSku})]}),(0,i.jsxs)(ie.Z,{children:[(0,i.jsxs)(ie.Z.Item,{children:[(0,i.jsx)("strong",{children:"Title:"})," ",a.title]}),(0,i.jsxs)(ie.Z.Item,{children:[(0,i.jsx)("strong",{children:"Handle:"})," ",a.handle]}),(0,i.jsxs)(ie.Z.Item,{children:[(0,i.jsx)("strong",{children:"Option 1:"})," ",a.option1]}),(0,i.jsxs)(ie.Z.Item,{children:[(0,i.jsx)("strong",{children:"Option 2:"})," ",a.option2]}),(0,i.jsxs)(ie.Z.Item,{children:[(0,i.jsx)("strong",{children:"Option 3:"})," ",a.option3]}),(0,i.jsxs)(ie.Z.Item,{children:[(0,i.jsx)("strong",{children:"Variant SKU:"})," ",a.variantSku]}),(0,i.jsxs)(ie.Z.Item,{children:[(0,i.jsx)("strong",{children:"Sensaria PID:"})," ",a.sensariaProductId]}),(0,i.jsxs)(ie.Z.Item,{children:[(0,i.jsx)("strong",{children:"Ship Method:"})," ",a.shippingMethod]}),(0,i.jsxs)(ie.Z.Item,{children:[(0,i.jsx)("strong",{children:"Artfile Needed:"})," ",a.artfileNeeded?"Yes":"No"]}),(0,i.jsxs)(ie.Z.Item,{children:[(0,i.jsx)("strong",{children:"Type:"})," ",a.fileType]}),(0,i.jsxs)(ie.Z.Item,{children:[(0,i.jsx)("strong",{children:"# of CX Images:"})," ",a.numberOfCxImages]})]})]}),"success"===r&&(0,i.jsx)("p",{className:"text-success",children:l}),"error"===r&&(0,i.jsx)("p",{className:"text-danger",children:l})]}),(0,i.jsxs)(ge.Z.Footer,{children:[o&&(0,i.jsx)("p",{className:"text-danger me-auto",children:o}),r?(0,i.jsx)(b.Z,{variant:"secondary",onClick:s,children:"Close"}):(0,i.jsxs)(i.Fragment,{children:[(0,i.jsx)(b.Z,{variant:"secondary",onClick:s,children:"Cancel"}),(0,i.jsx)(b.Z,{variant:"danger",onClick:n,children:"Delete"})]})]})]})}function ct(e){let{show:t,handleClose:s,newSku:a,setNewSku:n,createSku:r,productshippingprofiles:l,errorMessage:o}=e;const c=e=>{const{name:t,value:s,type:a,checked:r}=e.target;n("handle"===t?e=>({...e,[t]:s.replace(/\s/g,"-")}):"number"===a?e=>({...e,[t]:parseInt(s)||0}):"checkbox"===a?e=>({...e,[t]:r}):e=>({...e,[t]:s}))};return(0,i.jsxs)(ge.Z,{show:t,onHide:s,size:"lg",children:[(0,i.jsx)(ge.Z.Header,{closeButton:!0,children:(0,i.jsx)(ge.Z.Title,{children:"Create New SKU"})}),(0,i.jsxs)(ge.Z.Body,{children:[o&&(0,i.jsx)("p",{className:"text-danger",children:o}),(0,i.jsxs)(ae.Z,{children:[(0,i.jsxs)(ae.Z.Group,{className:"mb-3",children:[(0,i.jsx)(ae.Z.Label,{children:"Title"}),(0,i.jsx)(ae.Z.Control,{type:"text",name:"title",value:a.title,onChange:c})]}),(0,i.jsxs)(ae.Z.Group,{className:"mb-3",children:[(0,i.jsx)(ae.Z.Label,{children:"Handle"}),(0,i.jsx)(ae.Z.Control,{type:"text",name:"handle",value:a.handle.replace(/\s/g,"-"),onChange:c})]}),(0,i.jsxs)(ae.Z.Group,{className:"mb-3",children:[(0,i.jsx)(ae.Z.Label,{children:"Option 1"}),(0,i.jsx)(ae.Z.Control,{type:"text",name:"option1",value:a.option1,onChange:c})]}),(0,i.jsxs)(ae.Z.Group,{className:"mb-3",children:[(0,i.jsx)(ae.Z.Label,{children:"Option 2"}),(0,i.jsx)(ae.Z.Control,{type:"text",name:"option2",value:a.option2,onChange:c})]}),(0,i.jsxs)(ae.Z.Group,{className:"mb-3",children:[(0,i.jsx)(ae.Z.Label,{children:"Option 3"}),(0,i.jsx)(ae.Z.Control,{type:"text",name:"option3",value:a.option3,onChange:c})]}),(0,i.jsxs)(ae.Z.Group,{className:"mb-3",children:[(0,i.jsx)(ae.Z.Label,{children:"Variant SKU"}),(0,i.jsx)(ae.Z.Control,{type:"text",name:"variantSku",value:a.variantSku,onChange:c})]}),(0,i.jsxs)(ae.Z.Group,{className:"mb-3",children:[(0,i.jsx)(ae.Z.Label,{children:"Sensaria PID"}),(0,i.jsx)(ae.Z.Control,{type:"number",name:"sensariaProductId",value:a.sensariaProductId||"",onChange:c})]}),l&&(0,i.jsxs)(ae.Z.Group,{className:"mb-3",children:[(0,i.jsx)(ae.Z.Label,{children:"Shipping Method"}),(0,i.jsxs)(ae.Z.Select,{name:"shippingMethod",value:a.shippingMethod,onChange:c,children:[(0,i.jsx)("option",{value:null,children:"NONE"}),l.map((e=>(0,i.jsxs)("option",{value:e.id,children:[e.method," (",e.id,")"]},e.id)))]})]}),(0,i.jsxs)(ae.Z.Group,{className:"mb-3",children:[(0,i.jsx)(ae.Z.Label,{children:"Artfile Needed"}),(0,i.jsx)(ae.Z.Check,{type:"checkbox",name:"artfileNeeded",checked:a.artfileNeeded,onChange:c})]}),(0,i.jsxs)(ae.Z.Group,{className:"mb-3",children:[(0,i.jsx)(ae.Z.Label,{children:"Type"}),(0,i.jsxs)(ae.Z.Select,{name:"fileType",value:a.fileType,onChange:c,children:[(0,i.jsx)("option",{value:null,children:"NONE"}),(0,i.jsx)("option",{value:".jpg",children:".jpg"}),(0,i.jsx)("option",{value:".png",children:".png"})]})]}),(0,i.jsxs)(ae.Z.Group,{className:"mb-3",children:[(0,i.jsx)(ae.Z.Label,{children:"# of CX Images"}),(0,i.jsx)(ae.Z.Control,{type:"number",name:"numberOfCxImages",value:a.numberOfCxImages||0,onChange:c})]})]})]}),(0,i.jsxs)(ge.Z.Footer,{children:[o&&(0,i.jsx)("p",{className:"text-danger me-auto",children:o}),(0,i.jsx)(b.Z,{variant:"secondary",onClick:s,children:"Close"}),(0,i.jsx)(b.Z,{className:"btn-brand",onClick:r,disabled:!a.title||!a.handle||!a.variantSku||!a.option1,children:"Submit"})]})]})}function dt(){var e;const{lookupService:t,getProductShippingProfiles:s,productshippingprofiles:n}=(0,a.useContext)(W),[l,o]=(0,a.useState)([]),[c,d]=(0,a.useState)(""),[m,u]=(0,a.useState)([]),[x,j]=(0,a.useState)(!1),[g,N]=(0,a.useState)(!1),[w,Z]=(0,a.useState)(""),[k,y]=(0,a.useState)(""),[S,C]=(0,a.useState)(!1),[I,O]=(0,a.useState)(!1),[P,T]=(0,a.useState)(null),[A,U]=(0,a.useState)(""),[F,L]=(0,a.useState)(!1),[D,M]=(0,a.useState)(null),[E,G]=(0,a.useState)({title:"",handle:"",option1:"",option2:"",option3:"",variantSku:"",sensariaProductId:null,shippingMethod:null,artfileNeeded:!1,fileType:null,numberOfCxImages:0}),[B,z]=(0,a.useState)({title:"",handle:"",option1:"",option2:"",option3:"",sensariaProductId:null,shippingMethod:null,artfileNeeded:!1,fileType:null,numberOfCxImages:0}),[H,K]=(0,a.useState)(!1),R=(0,r.TH)(),Y=(0,r.s0)();(0,a.useEffect)((()=>{j(!0),t.getProducts().then((e=>{o(e.data),u(e.data),Z("");const t=new URLSearchParams(R.search),s=t.get("edit"),a=t.get("new");if(s){const t=e.data.find((e=>e.variantSku===s));t&&X(t)}a&&(G((e=>({...e,variantSku:a}))),L(!0))})).catch((e=>{N(!0),Z(e.message)})).finally((()=>{j(!1)})),s().then((e=>{console.log(e)})).catch((e=>{console.log(e)}))}),[t,s,R]);const _=(e,t)=>(0,i.jsx)(h.Z,{id:"button-tooltip",...e,children:t}),X=e=>{M(e),z({...e}),C(!0)},q=()=>{M(null),C(!1)},J=()=>{L(!1)},$=e=>[".png",".jpg",".jpeg"].includes(e),Q=m.filter((e=>(!e.sensariaProductId||!e.shippingMethod)&&(e.artfileNeeded||$(e.fileType)||e.numberOfCxImages>0))).length,ee=H?m.filter((e=>(!e.sensariaProductId||!e.shippingMethod)&&(e.artfileNeeded||$(e.fileType)||e.numberOfCxImages>0))):m;if(x||!n)return(0,i.jsx)(le,{size:"lg",message:"Loading skus...",variant:"dark"});if(g)return(0,i.jsxs)("div",{children:["Error: ",w]});return(0,i.jsxs)(i.Fragment,{children:[(null===(e=R.state)||void 0===e?void 0:e.from)&&(0,i.jsxs)(b.Z,{className:"btn-brand btn-sm mb-2",onClick:()=>{const e=R.state;e&&e.from?Y(e.from):Y(-1)},children:[(0,i.jsx)(v.G,{icon:f.OFe,className:"text-white me-2"}),"Back"]}),(0,i.jsxs)(Ie.Z,{className:"mb-3 sku-sticky-top shadow-sm",children:[(0,i.jsx)(ae.Z.Control,{type:"text",placeholder:"Start typing to search by SKU...",value:c,onChange:e=>{const t=e.target.value;d(t);const s=t?l.filter((e=>e.variantSku.toLowerCase().includes(t.toLowerCase()))):l;u(s)}}),(0,i.jsx)(p.Z,{placement:"top",overlay:e=>_(e,"Create New SKU"),children:(0,i.jsx)(b.Z,{variant:"",onClick:()=>{L(!0)},className:"btn-brand",children:(0,i.jsx)(v.G,{icon:f.EQ8,className:"text-white"})})})]}),Q>0&&(0,i.jsxs)(ve.Z,{variant:"warning",children:["Detected ",Q," SKU(s) that may be misconfigured.",(0,i.jsx)(b.Z,{className:"btn btn-brand btn-sm ms-2",onClick:()=>{K((e=>!e))},children:H?"Show All SKUs":"Show Misconfigured SKUs"})]}),ee&&(0,i.jsxs)(V.Z,{bordered:!0,hover:!0,className:"rounded-table",children:[(0,i.jsx)("thead",{children:(0,i.jsxs)("tr",{children:[(0,i.jsx)("th",{children:"Info"}),(0,i.jsx)("th",{children:"Title"}),(0,i.jsx)("th",{children:"Option 1"}),(0,i.jsx)("th",{children:"Option 2"}),(0,i.jsx)("th",{children:"Option 3"}),(0,i.jsx)("th",{children:"Variant SKU"}),(0,i.jsx)("th",{children:"Sensaria PID"}),(0,i.jsx)("th",{children:"Ship Method"}),(0,i.jsx)("th",{children:"Artfile Needed"}),(0,i.jsx)("th",{children:"Type"}),(0,i.jsx)("th",{children:"# of CX Images"}),(0,i.jsx)("th",{children:"Actions"})]})}),(0,i.jsx)("tbody",{children:ee.map((e=>(0,i.jsxs)("tr",{className:e.sensariaProductId&&e.shippingMethod||!(e.artfileNeeded||$(e.fileType)||e.numberOfCxImages>0)?"":"table-danger",children:[(0,i.jsx)("td",{className:"align-middle text-center",children:e.sensariaProductId&&e.shippingMethod||!(e.artfileNeeded||$(e.fileType)||e.numberOfCxImages>0)?(0,i.jsx)(v.G,{icon:f.fV7,className:"text-success"}):(0,i.jsx)(p.Z,{placement:"top",overlay:t=>{let s=[],a=[];e.sensariaProductId||s.push("Sensaria Product ID"),e.shippingMethod||s.push("Shipping Method"),e.artfileNeeded&&a.push("Artfile Needed"),$(e.fileType)&&a.push("File Type"),e.numberOfCxImages>0&&a.push("Number of CX Images");let n="This SKU may be set incorrectly. You have set ".concat(a.join(", ")," without setting ").concat(s.join(", "),".");return _(t,n)},children:(0,i.jsx)(v.G,{icon:f.RLE,className:"text-danger"})})}),(0,i.jsx)("td",{className:"text-truncate align-middle",style:{maxWidth:"200px"},title:e.title,children:e.title}),(0,i.jsx)("td",{className:"align-middle",children:e.option1}),(0,i.jsx)("td",{className:"align-middle",children:e.option2}),(0,i.jsx)("td",{className:"align-middle",children:e.option3}),(0,i.jsx)("td",{className:"align-middle",children:e.variantSku}),(0,i.jsx)("td",{className:"align-middle",children:e.sensariaProductId}),(0,i.jsx)("td",{className:"align-middle",children:e.shippingMethod}),(0,i.jsx)("td",{className:"align-middle",children:e.artfileNeeded?"Yes":"No"}),(0,i.jsx)("td",{className:"align-middle",children:e.fileType}),(0,i.jsx)("td",{className:"align-middle",children:e.numberOfCxImages}),(0,i.jsxs)("td",{className:"text-end d-flex align-middle",children:[(0,i.jsx)(b.Z,{variant:"secondary",className:"me-1",size:"sm",onClick:()=>X(e),children:(0,i.jsx)(v.G,{icon:f.Xcf,className:"text-white"})}),(0,i.jsx)(b.Z,{variant:"danger",className:"me-1",size:"sm",onClick:()=>(e=>{M(e),O(!0)})(e),children:(0,i.jsx)(v.G,{icon:f.$aW,className:"text-white"})})]})]},e.variantSku)))})]}),(0,i.jsx)(it,{show:S,handleClose:q,sku:B,handleEditChange:e=>{const{name:t,value:s,type:a,checked:n}=e.target;z("checkbox"===a?e=>({...e,[t]:n}):"number"===a?e=>({...e,[t]:parseInt(s)||0}):e=>({...e,[t]:s}))},updateSku:()=>{t.updateProduct(D.variantSku,B).then((()=>{const e=l.map((e=>e.variantSku===B.variantSku?B:e));o(e),u(e),q(),y("")})).catch((e=>{console.error("Error updating SKU:",e),y(e.response.data.Message)}))},errorMessage:k,productshippingprofiles:n,handleIgnoreSku:()=>(e=>{const s={...e,shippingMethod:"None",artfileNeeded:!1,fileType:"None",numberOfCxImages:0};t.updateProduct(e.variantSku,s).then((()=>{const e=l.map((e=>e.variantSku===s.variantSku?s:e));o(e),u(e),y(""),q()})).catch((e=>{console.error("Error updating SKU:",e),y(e.response.data.Message)}))})(B)}),(0,i.jsx)(ot,{show:I,handleClose:()=>{M(null),O(!1),T(null),U("")},sku:D,deleteSku:()=>{D&&t.deleteProduct(D.variantSku).then((()=>{T("success"),U("SKU ".concat(D.variantSku," deleted successfully."));const e=l.filter((e=>e.variantSku!==D.variantSku));o(e);const t=m.filter((e=>e.variantSku!==D.variantSku));u(t),y("")})).catch((e=>{T("error"),y(e.response.data.Message),U("Failed to delete SKU: ".concat(e.message))}))},deletionStatus:P,errorMessage:k,deletionMessage:A}),(0,i.jsx)(ct,{show:F,handleClose:J,newSku:E,setNewSku:G,createSku:()=>{t.createProduct(E).then((e=>{const t=l.concat(e.data);u(t),G({title:"",handle:"",option1:"",option2:"",option3:"",variantSku:"",sensariaProductId:null,shippingMethod:null,artfileNeeded:!1,fileType:"",numberOfCxImages:0}),J(),y("")})).catch((e=>{y(e.response.data.Message),console.log(e)}))},errorMessage:k,productshippingprofiles:n})]})}s(6342);var mt=s(3798);function ut(e){let{chart:t}=e;const s=null===t||void 0===t?void 0:t.name,a=null===t||void 0===t?void 0:t.kind,n=null===t||void 0===t?void 0:t.data;console.log(t);const r=()=>{var e;if(null===n||void 0===n)return(0,i.jsx)(i.Fragment,{});switch(a){case 10:return(0,i.jsx)(mt.by,{data:o(n),options:{legend:{display:window.innerWidth>500,position:"right",align:"center"}}});case 11:return(0,i.jsx)(mt.$Q,{data:o(n)});case 12:return(0,i.jsx)(mt.x1,{data:o(n)});case 13:return(0,i.jsx)(mt.xz,{data:o(n),options:{legend:{display:window.innerWidth>500,position:"right",align:"center"}}});case 20:return(0,i.jsx)(i.Fragment,{children:"Table"});case 21:return(0,i.jsxs)(k.Z,{pill:!0,bg:"secondary",children:[" ",null===(e=n.value)||void 0===e?void 0:e.toLocaleString()]})}},l=e=>21===e?2:6,o=e=>{if(e){const n=m(),r=[];var t=[];for(var s in e){console.log(s);const l=e[s];r.push({label:s,data:l.map((e=>e.count)),borderColor:12===a||11===a?n[0]:n,borderWidth:12===a?4:1,pointBackgroundColor:n[0],backgroundColor:12===a||11===a?c(n[0]):d(),hoverBackgroundColor:11===a?n[0]:m()}),t=l.map((e=>e.label))}return console.log(r),{labels:t,datasets:r}}},c=e=>{let t=e;return 7===e.length?t=e+"55":4===e.length&&(t=e+e.substring(1)+"55"),t},d=()=>{const e=m();for(let t=0;t<e.length;t++)e[t]=c(e[t]);return e},m=()=>{const e=getComputedStyle(document.body),t=["#f19a3e","#659157","#00b4d8","#d88c9a","#8e7dbe"];return t.push(e.getPropertyValue("--success")),t.push(e.getPropertyValue("--warning")),t.push(e.getPropertyValue("--danger")),t.push(e.getPropertyValue("--light")),t.push(e.getPropertyValue("--info")),t.push(e.getPropertyValue("--secondary")),t.push(e.getPropertyValue("--dark")),t};return void 0===s||null===s||void 0===a||null===a||void 0===n||null===n?(0,i.jsx)("p",{children:"Error loading chart data."}):(0,i.jsx)(i.Fragment,{children:(0,i.jsx)(he.Z,{sm:12,lg:l(a),className:"mb-3",children:(0,i.jsx)(w.Z,{children:(0,i.jsxs)(w.Z.Body,{children:[(0,i.jsx)(w.Z.Title,{className:"text-center",children:s}),(0,i.jsx)(w.Z.Body,{className:"text-center",children:(0,i.jsx)(r,{})})]})})})})}function ht(e){var t,s,n,r,l,o,c,m;let{item:u}=e;const{hasPermission:h}=(0,a.useContext)(P),{config:x}=(0,a.useContext)(d);return(0,i.jsxs)("tr",{children:[(0,i.jsx)("td",{children:(0,i.jsx)(k.Z,{pill:!0,bg:"secondary",style:{cursor:"pointer"},children:u.orderName})}),(0,i.jsx)("td",{children:(0,i.jsx)(X,{status:u.status})}),(0,i.jsx)("td",{children:u.shopifyOrderId}),(0,i.jsx)("td",{children:null===(t=u.metadata)||void 0===t||null===(s=t.customer)||void 0===s?void 0:s.FirstName}),(0,i.jsx)("td",{children:null===(n=u.metadata)||void 0===n||null===(r=n.customer)||void 0===r?void 0:r.LastName}),(0,i.jsx)("td",{children:null===(l=u.metadata)||void 0===l||null===(o=l.customer)||void 0===o?void 0:o.Email}),(0,i.jsx)("td",{children:null===(c=u.metadata)||void 0===c||null===(m=c.lineItems)||void 0===m?void 0:m.map((e=>{var t;return(0,i.jsx)(k.Z,{pill:!0,bg:"light border text-dark",className:"me-1",size:"sm",children:null===e||void 0===e||null===(t=e.LineItem)||void 0===t?void 0:t.Name},e.id)}))}),(0,i.jsxs)("td",{className:"d-flex align-items-center",style:{height:"4.1em"},children:[(0,i.jsx)(Y.rU,{to:"/details/".concat(u.shopifyOrderId),children:(0,i.jsx)(b.Z,{variant:"",className:"me-1 btn-brand",size:"sm",children:(0,i.jsx)(v.G,{icon:f.Xcf})})}),h("user:write")?(0,i.jsx)(b.Z,{href:"".concat(x.shopifyUrl,"/admin/orders/").concat(u.shopifyOrderId),rel:"noopener noreferrer",target:"_blank",variant:"success",className:"me-1 bg-shopify",size:"sm",children:(0,i.jsx)(v.G,{icon:_.yvx})}):null]})]},"".concat(u.orderId,"-").concat(u.shopifyOrderId,"-").concat(u.lastModified))}function xt(e){const t=new Date;switch(e){case"missingArtwork":return new Date(t-864e5).toISOString();case"missingPrintfile":return new Date(t-2592e5).toISOString();case"completedToday":return new Date(t.setHours(0,0,0,0)).toISOString();default:return new Date(0).toISOString()}}function jt(){const{dashboardService:e}=(0,a.useContext)(W),[t,s]=(0,a.useState)([]),[n,r]=(0,a.useState)("missingArtwork"),[l,o]=(0,a.useState)(3),[c,d]=(0,a.useState)(1),[m,u]=(0,a.useState)(10),[h,x]=(0,a.useState)(0),p={missingArtwork:3,sensariaFailure:9004,missingPrintfile:4,missingCXImages:9003,unknownSku:9001,completedToday:7};(0,a.useEffect)((()=>{let t={page:c,pageSize:m,status:[l],createdOnStart:xt(n),createdOnEnd:(new Date).toISOString(),descendingOrder:!0};void 0!==e&&e.getOrdersByStatus(t).then((e=>{s(e.data.results),x(e.data.totalItems)}),(e=>{console.error(e)}))}),[c,m,e,l,n]);return(0,i.jsx)(j.Z,{fluid:!0,children:(0,i.jsxs)(ue.Z,{className:"mb-3",children:[(0,i.jsx)(Ze.Z.Container,{id:"dashboard-tabs",defaultActiveKey:"missingArtwork",children:(0,i.jsxs)(ue.Z,{children:[(0,i.jsx)(he.Z,{sm:3,className:"p-2 bg-light rounded border border-muted sticky-top",style:{height:"max-content"},children:(0,i.jsx)(g.Z,{variant:"pills",className:"flex-column",children:Object.keys(p).map((e=>(0,i.jsx)(g.Z.Item,{children:(0,i.jsx)(g.Z.Link,{eventKey:e,onClick:()=>(e=>{r(e),o(p[e])})(e),className:n===e?"bg-brand":"text-muted",children:e.replace(/([A-Z])/g," $1").toUpperCase()})},e)))})}),(0,i.jsx)(he.Z,{sm:9,children:(0,i.jsx)(Ze.Z.Content,{children:(0,i.jsx)(Ze.Z.Pane,{eventKey:n,children:(0,i.jsxs)(V.Z,{striped:!0,bordered:!0,hover:!0,className:"rounded-table",children:[(0,i.jsx)("thead",{children:(0,i.jsxs)("tr",{children:[(0,i.jsx)("th",{children:"Order #"}),(0,i.jsx)("th",{children:"Status"}),(0,i.jsx)("th",{children:"Shopify Order ID"}),(0,i.jsx)("th",{children:"First"}),(0,i.jsx)("th",{children:"Last"}),(0,i.jsx)("th",{children:"Email"}),(0,i.jsx)("th",{children:"Products"}),(0,i.jsx)("th",{})]})}),(0,i.jsx)("tbody",{children:t.length>0?t.map((e=>(0,i.jsx)(ht,{item:e},e.id))):(0,i.jsx)("tr",{children:(0,i.jsx)("td",{colSpan:"100%",className:"text-center",children:"No data available"})})})]})})})})]})}),(0,i.jsx)(ne,{page:c,totalItems:h,pageSize:m,setPage:d,setPageSize:u})]})})}function gt(){const{dashboardService:e}=(0,a.useContext)(W),[t,s]=(0,a.useState)([]),[n,r]=(0,a.useState)(!0);return(0,a.useEffect)((()=>{r(!0),void 0!==e&&e.getCharts().then((e=>{s(e.data),console.log(e.data)}),(e=>{console.log(e)})).finally((()=>{r(!1)}))}),[e]),n?(0,i.jsx)(le,{size:"lg",variant:"dark"}):(0,i.jsxs)("div",{children:[null===t||void 0===t?void 0:t.map(((e,t)=>(0,i.jsx)(ue.Z,{children:e.charts.map(((e,t)=>(0,i.jsx)(ut,{chart:e},t)))},t))),(0,i.jsx)(jt,{})]})}const pt=()=>{const[e,t]=(0,a.useState)(!1),s=()=>{window.pageYOffset>300?t(!0):t(!1)};(0,a.useEffect)((()=>(window.addEventListener("scroll",s),()=>{window.removeEventListener("scroll",s)})),[]);return(0,i.jsx)(i.Fragment,{children:e&&(0,i.jsx)(b.Z,{className:"scroll-top-button btn-brand shadow rounded-circle",variant:"primary",onClick:()=>{window.scrollTo({top:0,behavior:"smooth"})},children:(0,i.jsx)(v.G,{icon:f.q9j})})})},bt=()=>{const[e,t]=(0,a.useState)(!0),s=()=>{window.pageYOffset<300?t(!0):t(!1)};(0,a.useEffect)((()=>(window.addEventListener("scroll",s),()=>{window.removeEventListener("scroll",s)})),[]);return(0,i.jsx)(i.Fragment,{children:e&&(0,i.jsxs)(b.Z,{className:"scroll-top-button btn-brand shadow rounded-circle",variant:"primary",onClick:()=>{window.scrollTo({top:document.documentElement.scrollHeight,behavior:"smooth"})},children:[(0,i.jsx)(v.G,{icon:f.dEo})," "]})})};const vt=function(){return(0,i.jsx)(i.Fragment,{children:(0,i.jsx)(c,{children:(0,i.jsx)(O,{children:(0,i.jsxs)(z,{children:[(0,i.jsxs)(r.Z5,{children:[(0,i.jsx)(r.AW,{path:"/",element:(0,i.jsx)(H,{children:(0,i.jsx)(Ne,{})})}),(0,i.jsx)(r.AW,{path:"/details/:orderId",element:(0,i.jsx)(H,{children:(0,i.jsx)(st,{})})}),(0,i.jsx)(r.AW,{path:"/distribution",element:(0,i.jsx)(H,{children:(0,i.jsx)(at,{})})}),(0,i.jsx)(r.AW,{path:"/skus",element:(0,i.jsx)(H,{children:(0,i.jsx)(dt,{})})}),(0,i.jsx)(r.AW,{path:"/dashboard",element:(0,i.jsx)(H,{permission:"user:write",children:(0,i.jsx)(gt,{})})}),(0,i.jsx)(r.AW,{path:"/unauthorized",element:(0,i.jsx)(K,{})}),(0,i.jsx)(r.AW,{path:"*",element:(0,i.jsxs)(i.Fragment,{children:[(0,i.jsx)("h1",{children:"404 - Page Not Found"}),(0,i.jsx)(v.G,{icon:f.e7M,className:"text-warning",size:"6x"}),(0,i.jsx)("h5",{children:"The page you are trying to access does not exist. If this problem persists, please contact the site administrator for additional support."}),(0,i.jsxs)("h5",{children:["Click ",(0,i.jsx)("a",{href:"/",children:"here"})," to return."]})]})})]}),(0,i.jsx)(pt,{}),(0,i.jsx)(bt,{}),(0,i.jsx)(lt,{})]})})})})},ft=e=>{e&&e instanceof Function&&s.e(216).then(s.bind(s,3253)).then((t=>{let{getCLS:s,getFID:a,getFCP:n,getLCP:r,getTTFB:l}=t;s(e),a(e),n(e),r(e),l(e)}))};n.createRoot(document.getElementById("root")).render((0,i.jsxs)(i.Fragment,{children:[(0,i.jsx)("link",{href:"/portal/ui/conf/style.css",rel:"stylesheet"}),(0,i.jsx)(Y.VK,{basename:"/portal/ui",children:(0,i.jsx)(vt,{})})]})),ft()}},e=>{e.O(0,[216],(()=>{return t=8575,e(e.s=t);var t}));e.O()}]);
//# sourceMappingURL=main.b3d55505.min.js.map